<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixyAi Pro - بوت كتابة الأكواد الذكي</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2d2e33;
            --secondary-color: #4f4f50;
            --accent-color: #494949be;
            --dark-color: #1a1a2e;
            --light-color: #f8f9fa;
            --success-color: #4cc9f0;
            --warning-color: #f8961e;
            --danger-color: #ef233c;
            --gray-color: #6c757d;
            --bg-gradient: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px 30px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .logo-icon {
            background: var(--accent-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-align: center;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.63);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover {
            background: #a1a1a1;
            box-shadow: 0 8px 25px rgba(45, 38, 48, 0.4);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Main Content Layout */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Sidebar Styles */
        .sidebar {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--card-border);
            height: fit-content;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .sidebar-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .sidebar-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        /* User Info Styles */
        .user-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-gradient);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            font-weight: bold;
            color: white;
        }

        .user-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-email {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .subscription-status {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .status-free {
            background: var(--gray-color);
        }

        .status-pro {
            background: linear-gradient(45deg, var(--accent-color), #f7f7f7);
        }

        .status-enterprise {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        }

        .usage-info {
            margin-top: 15px;
        }

        .usage-text {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), #f7f7f7);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        /* Language Tags */
        .language-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .language-tag {
            background: rgba(67, 97, 238, 0.2);
            border: 1px solid rgba(67, 97, 238, 0.3);
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* File Upload Styles */
        .file-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.1);
        }

        .file-upload:hover {
            border-color: var(--accent-color);
            background: rgba(104, 102, 104, 0.637);
        }

        .file-upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .file-upload-text {
            margin-bottom: 5px;
        }

        .file-upload-subtext {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Uploaded Files List */
        .uploaded-files-list {
            list-style: none;
            margin-top: 15px;
        }

        .file-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(67, 97, 238, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-size: 14px;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-meta {
            display: flex;
            gap: 10px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        /* Features List */
        .features-list {
            list-style: none;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .feature-item:last-child {
            border-bottom: none;
        }

        .feature-icon {
            color: var(--accent-color);
        }

        /* Chat Area Styles */
        .chat-area {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 0;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            height: 700px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-title {
            font-size: 18px;
            font-weight: 600;
        }

        .chat-tabs {
            display: flex;
            margin-right: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 5px;
        }

        .chat-tab {
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-tab.active {
            background: var(--accent-color);
            font-weight: 600;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 18px;
            animation: fadeIn 0.3s ease;
            position: relative;
            line-height: 1.5;
        }

        .user-message {
            background: linear-gradient(135deg, var(--primary-color), #4895ef);
            margin-left: auto;
            border-bottom-right-radius: 5px;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.2);
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.1);
            margin-right: auto;
            border-bottom-left-radius: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
            text-align: left;
        }

        .user-message .message-time {
            text-align: right;
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
        }

        .chat-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.3);
        }

        .chat-input input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .send-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent-color);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.63);
        }

        .send-button:hover {
            background: #a1a1a1;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(45, 38, 48, 0.4);
        }

        /* Code Editor Styles */
        .code-editor {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-family: 'Tajawal', sans-serif;
        }

        .code-language {
            background: rgba(0, 0, 0, 0.3);
            padding: 3px 10px;
            border-radius: 50px;
            font-size: 12px;
            text-transform: uppercase;
        }

        .code-actions {
            display: flex;
            gap: 10px;
        }

        .code-action {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .code-action:hover {
            background: var(--accent-color);
        }

        /* Features Section */
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--card-border);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 20px;
            color: var(--accent-color);
            width: 70px;
            height: 70px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(104, 102, 104, 0.637);
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Pricing Section */
        .pricing-section {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid var(--card-border);
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .plan-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .plan-card.popular {
            border: 1px solid var(--accent-color);
            transform: scale(1.02);
        }

        .plan-card.popular::before {
            content: 'الأكثر شهرة';
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--accent-color);
            color: white;
            padding: 3px 10px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
        }

        .plan-name {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .plan-price {
            font-size: 40px;
            font-weight: 700;
            margin: 20px 0;
            color: white;
        }

        .plan-price small {
            font-size: 16px;
            font-weight: normal;
            color: var(--text-secondary);
        }

        .plan-features {
            list-style: none;
            margin: 30px 0;
            text-align: right;
        }

        .plan-features li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plan-features li::before {
            content: '✓';
            color: var(--success-color);
            font-weight: bold;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--dark-color);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.3);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .form-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-footer a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .chat-area {
                order: 1;
                height: 600px;
                margin-bottom: 30px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .pricing-plans {
                grid-template-columns: 1fr;
            }
            
            .plan-card.popular {
                transform: none;
            }
            
            .modal-content {
                width: 90%;
                padding: 30px 20px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .mt-10 {
            margin-top: 10px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-10 {
            margin-bottom: 10px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <span>PixyAi Pro</span>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="showModal('loginModal')">
                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                </button>
                <button class="btn btn-primary" onclick="showModal('registerModal')">
                    <i class="fas fa-user-plus"></i> إنشاء حساب
                </button>
                <button class="btn btn-secondary hidden" id="logoutBtn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> تسجيل خروج
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="user-info hidden" id="userInfo">
                    <div class="user-avatar" id="userAvatar">م</div>
                    <h3 class="user-name" id="userName">مستخدم جديد</h3>
                    <p class="user-email" id="userEmail">user@example.com</p>
                    <div class="subscription-status status-free" id="userStatus">مجاني</div>
                    
                    <div class="usage-info">
                        <div class="usage-text">
                            <span>استخدام اليوم</span>
                            <span id="usageText">0/10 طلبات</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="usageProgress"></div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-code"></i> لغات البرمجة المدعومة
                    </h3>
                    <div class="language-tags">
                        <span class="language-tag">
                            <i class="fab fa-html5"></i> HTML
                        </span>
                        <span class="language-tag">
                            <i class="fab fa-css3-alt"></i> CSS
                        </span>
                        <span class="language-tag">
                            <i class="fas fa-code"></i> Lua
                        </span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-file-upload"></i> رفع الملفات
                    </h3>
                    <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                        <div class="file-upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p class="file-upload-text">اسحب وأفلت الملف هنا أو انقر للرفع</p>
                        <p class="file-upload-subtext">يدعم: .lua, .html, .css</p>
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".lua,.html,.css" onchange="handleFileUpload(this)">
                </div>

                <div class="sidebar-section" id="uploadedFilesSection">
                    <h3 class="sidebar-title">
                        <i class="fas fa-folder-open"></i> الملفات المرفوعة
                    </h3>
                    <div id="uploadedFiles">
                        <p style="color: var(--text-secondary); text-align: center; font-size: 14px;">
                            لا توجد ملفات مرفوعة بعد
                        </p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-star"></i> المميزات
                    </h3>
                    <ul class="features-list">
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>كتابة أكواد ذكية</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>تعديل الأكواد</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>دعم +100K سطر</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>سرعة فائقة</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>تحليل الأخطاء</span>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-header">
                    <div class="chat-tabs">
                        <div class="chat-tab active">المحادثة</div>
                        <div class="chat-tab">الأكواد</div>
                        <div class="chat-tab">التاريخ</div>
                    </div>
                    <h3 class="chat-title">
                        <i class="fas fa-robot"></i> PixyAi Pro
                    </h3>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot-message">
                        <div class="message-content">
                            مرحباً! أنا PixyAi Pro 🤖<br>
                            يمكنني مساعدتك في:<br>
                            • كتابة أكواد Lua, HTML, CSS<br>
                            • تعديل وتحسين الأكواد<br>
                            • كتابة أكثر من 100,000 سطر بسرعة<br>
                            • تحليل وإصلاح الأخطاء
                        </div>
                        <div class="message-time">الآن</div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" id="messageInput" placeholder="اكتب طلبك هنا... مثل: اكتب لي موقع HTML بسيط">
                        <button class="send-button" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <section class="features-section">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-rocket"></i>
                </div>
                <h3 class="feature-title">سرعة فائقة</h3>
                <p class="feature-description">كتابة أكواد تصل إلى 100,000 سطر في ثوانٍ معدودة مع تحسين الأداء</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <h3 class="feature-title">دقة عالية</h3>
                <p class="feature-description">أكواد محسّنة وخالية من الأخطاء مع            </div>
            <div class="feature-card">
                <div class="feature-icon">🔧</div>
                <h3>تعديل ذكي</h3>
                <p>تحليل وتعديل الأكواد الموجودة مع اقتراح التحسينات</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">📁</div>
                <h3>دعم الملفات</h3>
                <p>رفع وتحليل ملفات Lua, HTML, CSS مع حفظ التاريخ</p>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section">
            <h2 style="text-align: center; margin-bottom: 20px;">💎 خطط الاشتراك</h2>
            <p style="text-align: center; opacity: 0.8;">اختر الخطة المناسبة لاحتياجاتك</p>
            
            <div class="pricing-plans">
                <div class="plan-card">
                    <h3>مجاني</h3>
                    <div class="plan-price">$0<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>10 طلبات يومياً</li>
                        <li>دعم أساسي للغات</li>
                        <li>حد أقصى 1000 سطر</li>
                        <li>حفظ لمدة يوم واحد</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="selectPlan('free')">البدء مجاناً</button>
                </div>

                <div class="plan-card popular">
                    <h3>Pro</h3>
                    <div class="plan-price">$29<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>500 طلب يومياً</li>
                        <li>جميع اللغات المدعومة</li>
                        <li>حد أقصى 50,000 سطر</li>
                        <li>حفظ لمدة شهر</li>
                        <li>دعم أولوية</li>
                        <li>تحليل متقدم للأخطاء</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('pro')">اشترك الآن</button>
                </div>

                <div class="plan-card">
                    <h3>Enterprise</h3>
                    <div class="plan-price">$99<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>طلبات غير محدودة</li>
                        <li>جميع المميزات</li>
                        <li>حد أقصى 100,000+ سطر</li>
                        <li>حفظ دائم</li>
                        <li>دعم مخصص 24/7</li>
                        <li>API مخصص</li>
                        <li>تدريب فريق العمل</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('enterprise')">تواصل معنا</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>تسجيل الدخول</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="loginEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="loginPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">دخول</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('loginModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h2>إنشاء حساب جديد</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label>الاسم الكامل</label>
                    <input type="text" id="registerName" placeholder="اسمك الكامل" required>
                </div>
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="registerEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="registerPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">إنشاء حساب</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('registerModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userUsage = 0;
        let dailyLimit = 10;
        let userFiles = [];
        let conversationHistory = [];

        // Sample code templates
        const codeTemplates = {
            lua: {
                basic: `-- Lua Script Example
function greet(name)
    return "Hello, " .. name .. "!"
end

local userName = "User"
print(greet(userName))

-- Table example
local myTable = {
    name = "PixyAi",
    version = "1.0",
    features = {"Fast", "Smart", "Reliable"}
}

for i, feature in ipairs(myTable.features) do
    print(i .. ". " .. feature)
end`,
                
                advanced: `-- Advanced Lua Application
local json = require("json")
local http = require("socket.http")

-- Class definition
local WebAPI = {}
WebAPI.__index = WebAPI

function WebAPI:new(baseUrl)
    local instance = {
        baseUrl = baseUrl,
        headers = {
            ["Content-Type"] = "application/json",
            ["User-Agent"] = "Lua-PixyAi/1.0"
        }
    }
    setmetatable(instance, WebAPI)
    return instance
end

function WebAPI:get(endpoint)
    local url = self.baseUrl .. endpoint
    local response, status = http.request(url)
    
    if status == 200 then
        return json.decode(response)
    else
        error("HTTP Error: " .. status)
    end
end

function WebAPI:post(endpoint, data)
    local url = self.baseUrl .. endpoint
    local jsonData = json.encode(data)
    
    local response, status = http.request{
        url = url,
        method = "POST",
        headers = self.headers,
        source = ltn12.source.string(jsonData)
    }
    
    return json.decode(response)
end

-- Usage example
local api = WebAPI:new("https://api.example.com/")
local userData = api:get("/users/123")
print("User: " .. userData.name)`
            },
            
            html: {
                basic: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع بسيط</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>مرحباً بك في موقعي</h1>
        <p>هذا موقع بسيط تم إنشاؤه بواسطة PixyAi Pro</p>
        <button class="btn" onclick="alert('مرحباً!')">اضغط هنا</button>
    </div>
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
</body>
</html>`,
                
                advanced: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق ويب متقدم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .app-container {
            display: grid;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            grid-template-rows: 80px 1fr 60px;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }
        
        .header {
            grid-area: header;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .sidebar {
            grid-area: sidebar;
            background: rgba(0,0,0,0.2);
            padding: 30px 20px;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .main-content {
            grid-area: main;
            padding: 30px;
            overflow-y: auto;
        }
        
        .footer {
            grid-area: footer;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .nav-item {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .nav-item.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: bold;
            color: #ff6b6b;
            display: block;
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
                grid-template-columns: 1fr;
                grid-template-rows: 80px 1fr 60px;
            }
            
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>🚀 تطبيق الويب المتقدم</h1>
            <div>
                <button class="btn">الإعدادات</button>
                <button class="btn">تسجيل خروج</button>
            </div>
        </header>
        
        <aside class="sidebar">
            <a href="#" class="nav-item active">الرئيسية</a>
            <a href="#" class="nav-item">التحليلات</a>
            <a href="#" class="nav-item">المستخدمون</a>
            <a href="#" class="nav-item">الإعدادات</a>
        </aside>
        
        <main class="main-content">
            <div class="dashboard-grid">
                <div class="card stat-card">
                    <span class="stat-number">1,234</span>
                    <span>زيارات اليوم</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">567</span>
                    <span>مستخدم نشط</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">89%</span>
                    <span>معدل التفاعل</span>
                </div>
            </div>
            
            <div class="card">
                <h2>آخر النشاطات</h2>
                <p>هنا يمكنك عرض آخر النشاطات والأحداث في التطبيق الخاص بك.</p>
            </div>
        </main>
        
        <footer class="footer">
            <p>© 2023 PixyAi Pro - جميع الحقوق محفوظة</p>
        </footer>
    </div>
</body>
</html>`
            },
            
            css: {
                basic: `/* CSS Basic Example */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
    color: #333;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    padding: 20px;
    text-align: center;
    border-radius: 10px;
    margin-bottom: 30px;
}

.btn {
    display: inline-block;
    padding: 12px 24px;
    background: #ff6b6b;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn:hover {
    background: #ee5a24;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}`,
                
                advanced: `/* Advanced CSS Example */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
    --accent-color: #ff6b6b;
    --text-color: #333;
    --light-bg: #f9f9f9;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
    --shadow-md: 0 5px 15px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--light-bg);
}

.container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.grid {
    display: grid;
    gap: 30px;
}

.grid-2 {
    grid-template-columns: repeat(2, 1fr);
}

.grid-3 {
    grid-template-columns: repeat(3, 1fr);
}

.grid-4 {
    grid-template-columns: repeat(4, 1fr);
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 12px 24px;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
}

.btn-primary {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

@media (max-width: 768px) {
    .grid-2, 
    .grid-3, 
    .grid-4 {
        grid-template-columns: 1fr;
    }
    
    .btn {
        padding: 10px 20px;
    }
}`
            }
        };

        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userStatus = document.getElementById('userStatus');
        const usageProgress = document.getElementById('usageProgress');
        const usageText = document.getElementById('usageText');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const uploadedFiles = document.getElementById('uploadedFiles');

        // Initialize the app
        function init() {
            // Check if user is logged in (from localStorage)
            const savedUser = localStorage.getItem('PixyAiUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserUI();
            }

            // Add event listeners
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            
            // Allow sending message with Enter key
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple validation
            if (!email || !password) {
                alert('الرجاء إدخال البريد الإلكتروني وكلمة المرور');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: 'مستخدم جديد',
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('loginModal');
            
            // Reset form
            loginForm.reset();
        }

               // Handle register
                // Handle register
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            // Simple validation
            if (!name || !email || !password) {
                alert('الرجاء إدخال جميع الحقول المطلوبة');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: name,
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('registerModal');
            
            // Reset form
            registerForm.reset();
        }

        // Logout user
        function logout() {
            currentUser = null;
            userUsage = 0;
            userFiles = [];
            conversationHistory = [];
            
            // Remove from localStorage
            localStorage.removeItem('PixyAiUser');
            
            // Update UI
            updateUserUI();
            
            // Clear chat
            chatMessages.innerHTML = `
                <div class="bot-message">
                    مرحباً! أنا PixyAi Pro 🤖<br>
                    يمكنني مساعدتك في:<br>
                    • كتابة أكواد Lua, HTML, CSS<br>
                    • تعديل وتحسين الأكواد<br>
                    • كتابة أكثر من 100,000 سطر بسرعة<br>
                    • تحليل وإصلاح الأخطاء<br><br>
                    كيف يمكنني مساعدتك اليوم؟
                </div>
            `;
        }

        // Update user UI
        function updateUserUI() {
            if (currentUser) {
                // Show user info and logout button
                userInfo.classList.remove('hidden');
                logoutBtn.classList.remove('hidden');
                
                // Hide login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.add('hidden');
                });
                
                // Set user info
                userName.textContent = `مرحباً ${currentUser.name}!`;
                
                // Set plan info
                userStatus.textContent = currentUser.plan === 'free' ? 'مجاني' : 
                                      currentUser.plan === 'pro' ? 'Pro' : 'Enterprise';
                userStatus.className = 'subscription-status ' + 
                                      (currentUser.plan === 'free' ? 'status-free' : 
                                       currentUser.plan === 'pro' ? 'status-pro' : 'status-enterprise');
                
                // Update usage
                updateUsage();
            } else {
                // Hide user info and logout button
                userInfo.classList.add('hidden');
                logoutBtn.classList.add('hidden');
                
                // Show login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.remove('hidden');
                });
            }
        }

        // Update usage progress
        function updateUsage() {
            if (!currentUser) return;
            
            const maxRequests = currentUser.plan === 'free' ? 10 : 
                              currentUser.plan === 'pro' ? 500 : Infinity;
            
            const percentage = Math.min((userUsage / maxRequests) * 100, 100);
            usageProgress.style.width = `${percentage}%`;
            usageText.textContent = currentUser.plan === 'enterprise' ? 
                                  'طلبات غير محدودة' : 
                                  `${userUsage}/${maxRequests} طلبات`;
        }

        // Handle file upload
        function handleFileUpload(input) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لرفع الملفات');
                return;
            }
            
            const file = input.files[0];
            if (!file) return;
            
            // Check file type
            const validExtensions = ['.lua', '.html', '.css'];
            const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
            
            if (!validExtensions.includes(fileExt)) {
                alert('نوع الملف غير مدعوم. الرجاء رفع ملفات بصيغة .lua أو .html أو .css فقط');
                return;
            }
            
            // Read file content
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                // Add to user files
                userFiles.push({
                    name: file.name,
                    content: content,
                    type: fileExt.substring(1),
                    date: new Date().toLocaleString()
                });
                
                // Display uploaded file
                displayUploadedFiles();
                
                // Add bot message
                addBotMessage(`تم رفع الملف "${file.name}" بنجاح. يمكنك الآن طلب تعديله أو تحليله.`);
            };
            reader.readAsText(file);
        }

        // Display uploaded files
        function displayUploadedFiles() {
            if (userFiles.length === 0) {
                uploadedFiles.innerHTML = '';
                return;
            }
            
            let html = '<h3>📂 الملفات المرفوعة</h3><ul style="list-style: none; margin-top: 10px;">';
            
            userFiles.forEach((file, index) => {
                html += `
                    <li style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${file.name}</span>
                            <small>${file.date}</small>
                        </div>
                        <small style="color: rgba(255,255,255,0.7);">${file.type.toUpperCase()} - ${Math.ceil(file.content.length / 1024)} KB</small>
                        <div style="margin-top: 5px;">
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="analyzeFile(${index})">تحليل</button>
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="editFile(${index})">تعديل</button>
                        </div>
                    </li>
                `;
            });
            
            html += '</ul>';
            uploadedFiles.innerHTML = html;
        }

        // Analyze file
        function analyzeFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            let analysis = '';
            
            // Simple analysis based on file type
            if (file.type === 'lua') {
                analysis = `تحليل ملف Lua:
- عدد الأسطر: ${file.content.split('\n').length}
- عدد الدوال: ${(file.content.match(/function/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/local\s+\w+/g) || []).length}
- يحتوي على: ${file.content.includes('require') ? 'وحدات خارجية' : 'لا يوجد وحدات خارجية'}`;
            } else if (file.type === 'html') {
                analysis = `تحليل ملف HTML:
- عدد العناصر: ${(file.content.match(/<\w+/g) || []).length}
- يحتوي على: ${file.content.includes('<style>') ? 'CSS داخلي' : 'لا يوجد CSS داخلي'}
- يحتوي على: ${file.content.includes('<script>') ? 'JavaScript داخلي' : 'لا يوجد JavaScript داخلي'}`;
            } else if (file.type === 'css') {
                analysis = `تحليل ملف CSS:
- عدد القواعد: ${(file.content.match(/[^{]+\{[^}]+\}/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/--[\w-]+:/g) || []).length}
- يحتوي على: ${file.content.includes('@media') ? 'استعلامات وسائط' : 'لا يوجد استعلامات وسائط'}`;
            }
            
            addBotMessage(analysis);
            incrementUsage();
        }

        // Edit file
        function editFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            addUserMessage(`أريد تعديل ملف ${file.name}`);
            
            // Simulate bot thinking
            setTimeout(() => {
                let editedContent = '';
                
                // Simple edits based on file type
                if (file.type === 'lua') {
                    editedContent = file.content + '\n\n-- تمت إضافة هذا التعليق بواسطة PixyAi Pro';
                } else if (file.type === 'html') {
                    editedContent = file.content.replace(/<\/body>/, '<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->\n</body>');
                } else if (file.type === 'css') {
                    editedContent = file.content + '\n\n/* تمت إضافة هذا التعليق بواسطة PixyAi Pro */';
                }
                
                // Update file content
                userFiles[index].content = editedContent;
                
                // Show edited content
                addBotMessage(`تم تعديل الملف ${file.name}. إليك المحتوى المعدل:`);
                addCodeMessage(editedContent, file.type);
                
                incrementUsage();
            }, 1500);
        }

        // Select plan
        function selectPlan(plan) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لتغيير الخطة');
                return;
            }
            
            currentUser.plan = plan;
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            updateUserUI();
            
            if (plan === 'enterprise') {
                addBotMessage('شكراً لاهتمامك بخطة Enterprise! سيتصل بك فريق الدعم قريباً.');
            } else {
                addBotMessage(`تم تحديث اشتراكك إلى الخطة ${plan === 'pro' ? 'Pro' : 'المجانية'} بنجاح.`);
            }
        }

        // Send message
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لإرسال الرسائل');
                return;
            }
            
            // Check daily limit
            if (currentUser.plan === 'free' && userUsage >= 10) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة المجانية. قم بالترقية لطلب المزيد.');
                return;
            } else if (currentUser.plan === 'pro' && userUsage >= 500) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة Pro. قم بالترقية إلى Enterprise لطلبات غير محدودة.');
                return;
            }
            
            addUserMessage(message);
            messageInput.value = '';
            
            // Simulate bot thinking
            setTimeout(() => {
                generateBotResponse(message);
                incrementUsage();
            }, 1000);
        }


// Generate bot response
function generateBotResponse(message) {
    let response = '';
    let code = '';
    
    // Convert message to lowercase for easier matching
    const lowerMessage = message.toLowerCase();
    
    // Check language and respond accordingly
    const isNonArabic = /[a-z]/.test(message);
    
    if (isNonArabic) {
        response = generateEnglishResponse(message);
    } else {
        // Handle Arabic responses
        response = generateArabicResponse(message);
    }
    
    addBotMessage(response);
    
    if (code) {
        addCodeMessage(code, lowerMessage.includes('لوا') ? 'lua' : 
                         lowerMessage.includes('html') ? 'html' : 'css');
    }
}

function generateArabicResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    // Handle greetings
    if (lowerMessage.includes('السلام عليكم') || lowerMessage.includes('سلام') || 
        lowerMessage.includes('مرحبا') || lowerMessage.includes('اهلا') || 
        lowerMessage.includes('مرحباً') || lowerMessage.includes('أهلا')) {
        const greetings = [
            "وعليكم السلام ورحمة الله وبركاته! كيف يمكنني مساعدتك اليوم؟",
            "مرحباً بك! كيف أساعدك اليوم؟",
            "أهلاً وسهلاً! كيف يمكنني خدمتك؟",
            "وعليكم السلام! كيف حالك اليوم؟"
        ];
        return greetings[Math.floor(Math.random() * greetings.length)];
    }
    
    // Handle general questions
    if (lowerMessage.includes('؟') || lowerMessage.includes('ما') || 
        lowerMessage.includes('كيف') || lowerMessage.includes('لماذا') || 
        lowerMessage.includes('أين') || lowerMessage.includes('متى')) {
        return getGeneralKnowledgeAnswer(message);
    }
    
    // Default response for other messages
    return "أنا هنا لمساعدتك في أي موضوع. هل يمكنك توضيح طلبك أكثر؟";
}


// Update English response function similarly
function generateEnglishResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    // Handle greetings
    if (lowerMessage.includes('hi') || lowerMessage.includes('hello') || 
        lowerMessage.includes('hey') || lowerMessage.includes('greetings')) {
        const greetings = [
            "Hello! How can I help you today?",
            "Hi there! What can I do for you?",
            "Greetings! How may I assist you?",
            "Hello! Nice to see you. How can I help?"
        ];
        return greetings[Math.floor(Math.random() * greetings.length)];
    }
    
    // Handle general questions
    if (lowerMessage.includes('?') || lowerMessage.includes('what') || 
        lowerMessage.includes('how') || lowerMessage.includes('why') || 
        lowerMessage.includes('when') || lowerMessage.includes('where')) {
        return getEnglishGeneralAnswer(message);
    }
    
    // Default response for other messages
    return "I'm here to help with any topic. Could you clarify your request?";
}

function getEnglishGeneralAnswer(question) {
    const lowerQuestion = question.toLowerCase();
    
    // Extensive knowledge base in English
    const knowledgeBase = {
        // General
        "what is your name": "I'm PixyAi Pro, your smart programming assistant!",
        "who created you": "I was developed to help programmers and developers in their daily work",
        
        // Technology
        "what is programming": "Programming is the process of creating instructions for computers to execute",
        "what is artificial intelligence": "AI is the simulation of human intelligence in machines programmed to think like humans",
        
        // Science
        "how are clouds formed": "Clouds form when water evaporates from the surface and rises to cooler altitudes where it condenses",
        "what is gravity": "Gravity is the force that attracts objects toward each other, it's what keeps us grounded on Earth",
        
        // History
        "who discovered america": "Christopher Columbus is credited with discovering America in 1492",
        "when did world war ii end": "World War II ended in 1945",
        
        // Math
        "what is a prime number": "A prime number is a natural number greater than 1 that has no positive divisors other than 1 and itself",
        "what is pythagorean theorem": "In a right triangle, the square of the hypotenuse equals the sum of the squares of the other two sides"
    };
    
    // Find the best match
    for (const [key, value] of Object.entries(knowledgeBase)) {
        if (lowerQuestion.includes(key.toLowerCase())) {
            return value;
        }
    }
    
    // Fallback responses
    const fallbackResponses = [
        "That's an interesting question! I don't have specific information on that topic. Can I help with something else?",
        "I'm more specialized in programming and tech fields, but regarding your question... it would require more research.",
        "I don't have an exact answer for that right now, but I can help with other topics.",
        "That's outside my main area of expertise, but I'm constantly learning. Do you have other questions?"
    ];
    
    return fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
}

// Get general knowledge answer
// موسوعة معرفية واسعة بالعربية
const knowledgeBase = {
    // معلومات عامة
    "ما هو اسمك": "أنا PixyAi Pro، مساعدك الذكي في البرمجة والتقنية!",
    "من صنعك": "تم تطويري لمساعدة المبرمجين والمطورين في أعمالهم اليومية",
    
    // جغرافيا
    "كم درجة الحرارة في الكويت": "درجة الحرارة في الكويت تتراوح بين 45°م صيفاً و8°م شتاءً في المتوسط",
    "ما هي عاصمة فرنسا": "باريس هي العاصمة الجميلة لفرنسا",
    "ما هي أكبر دولة في العالم": "روسيا هي أكبر دولة في العالم من حيث المساحة",
    "ما هي أعلى قمة في العالم": "قمة إفرست هي أعلى قمة في العالم بارتفاع 8848 متراً",
    
    // علوم
    "كيف تتكون السحب": "تتكون السحب عندما يتبخر الماء من الأرض ويصعد إلى الأعلى حيث يبرد ويتكثف",
    "ما هي الجاذبية": "الجاذبية هي القوة التي تجذب الأجسام نحو بعضها البعض، وهي ما يجعلنا ملتصقين بالأرض",
    "ما هو التركيب الضوئي": "التركيب الضوئي هو عملية تقوم بها النباتات لتحويل ضوء الشمس إلى طاقة كيميائية",
    "كم عدد العظام في جسم الإنسان": "يحتوي جسم الإنسان البالغ على 206 عظمة",
    
    // تاريخ
    "من اكتشف أمريكا": "كريستوفر كولومبوس هو الذي اكتشف أمريكا عام 1492",
    "متى انتهت الحرب العالمية الثانية": "انتهت الحرب العالمية الثانية في عام 1945",
    "من هو أول رائد فضاء": "يوري جاجارين كان أول إنسان يصل إلى الفضاء عام 1961",
    "متى تأسست السعودية": "تأسست المملكة العربية السعودية عام 1932م",
    
    // رياضيات
    "ما هو العدد الأولي": "العدد الأولي هو عدد طبيعي أكبر من 1 ليس له قواسم غير نفسه والواحد",
    "ما هي نظرية فيثاغورث": "في المثلث القائم، مربع الوتر يساوي مجموع مربعي الضلعين الآخرين",
    "ما هو العدد الذهبي": "العدد الذهبي هو (1+√5)/2 ≈ 1.618 ويظهر كثيراً في الفن والطبيعة",
    
    // تقنية
    "ما هي لغة البرمجة": "لغات البرمجة هي وسيلة للتواصل مع الحواسيب وتوجيهها لأداء مهام محددة",
    "ما هو الذكاء الاصطناعي": "الذكاء الاصطناعي هو محاكاة الذكاء البشري في الآلات المبرمجة للتفكير مثل البشر",
    "ما هو الفرق بين HTTP و HTTPS": "HTTPS هو النسخة الآمنة من HTTP حيث يتم تشفير البيانات المتبادلة",
    
    // ثقافة عامة
    "من هو مؤلف كتاب الشفرة": "دان براون هو مؤلف رواية شفرة دافنشي الشهيرة",
    "ما هي عملة اليابان": "الين الياباني هو العملة الرسمية لليابان",
    "كم عدد أيام السنة الكبيسة": "السنة الكبيسة لها 366 يوماً حيث يضاف يوم إلى فبراير كل 4 سنوات",
    
    // طب وصحة
    "ما هو معدل ضغط الدم الطبيعي": "المعدل الطبيعي لضغط الدم هو حوالي 120/80 ملم زئبق",
    "ما هي أعراض الإنفلونزا": "تشمل الحمى، السعال، التهاب الحلق، آلام العضلات والتعب",
    "كم لتر من الماء يجب شربه يومياً": "يوصى بشرب حوالي 2-3 لترات يومياً للشخص البالغ",
    
    // اقتصاد
    "ما هي أكبر شركة في العالم": "أبل وسامسونج وأمازون من بين أكبر الشركات حسب القيمة السوقية",
    "ما هو الناتج المحلي الإجمالي": "هو القيمة السوقية لكل السلع والخدمات المنتجة في بلد ما خلال سنة",
    
    // دين
    "كم عدد أركان الإسلام": "أركان الإسلام خمسة: الشهادتان، الصلاة، الزكاة، الصوم، والحج",
    "ما هي آخر سورة في القرآن": "سورة الناس هي آخر سورة في المصحف الشريف",
    
    // رياضة
    "من هو هداف كأس العالم التاريخي": "ميروسلاف كلوزه الألماني برصيد 16 هدفاً في كأس العالم",
    "كم عدد لاعبي كرة القدم": "11 لاعباً لكل فريق في كرة القدم",
    
    // حيوانات
    "ما هو أسرع حيوان في العالم": "الفهد الصياد هو أسرع حيوان بري بسرعة تصل إلى 120 كم/ساعة",
    "كم تعيش السلحفاة": "بعض أنواع السلاحف يمكن أن تعيش أكثر من 100 عام"
};
    
    // البحث عن أفضل تطابق
    for (const [key, value] of Object.entries(knowledgeBase)) {
        if (lowerQuestion.includes(key.toLowerCase())) {
            return value;
        }
    }
    
    // إذا لم يتم العثور على إجابة محددة
    const fallbackResponses = [
        "هذا سؤال مثير للاهتمام! للأسف لدي معلومات محدودة عن هذا الموضوع المحدد. هل يمكنني مساعدتك في شيء آخر؟",
        "أنا متخصص أكثر في مجال البرمجة والتقنية، ولكن حسب معلوماتي... هذا الموضوع يحتاج إلى مزيد من البحث.",
        "حاليا لا أملك إجابة دقيقة عن هذا السؤال، لكني يمكنني مساعدتك في مواضيع أخرى.",
        "هذا خارج نطاق تخصصي الأساسي، لكني أحاول التعلم باستمرار. هل لديك أسئلة أخرى؟"
    ];
    
    return fallbackResponses[Math.floor(Math.random() * fallbackResponses.length)];
}

// Get English general knowledge answer
function getEnglishGeneralAnswer(question) {
    const lowerQuestion = question.toLowerCase();
    
    // Sample knowledge base in English
    if (lowerQuestion.includes('sun') || lowerQuestion.includes('solar')) {
        return "The Sun is the star at the center of our solar system. Earth orbits around the Sun once every 365.25 days, causing the seasons to change.";
    }
    else if (lowerQuestion.includes('moon') || lowerQuestion.includes('lunar')) {
        return "The Moon is Earth's only natural satellite. It takes about 27.3 days to orbit Earth and causes the tides.";
    }
    else if (lowerQuestion.includes('programming') || lowerQuestion.includes('developer')) {
        return "Programming is the process of writing instructions for computers to perform specific tasks. Popular programming languages include Python, JavaScript, Java, and C++.";
    }
    else if (lowerQuestion.includes('artificial intelligence') || lowerQuestion.includes('ai')) {
        return "Artificial Intelligence is a field of computer science focused on creating systems that can perform tasks requiring human intelligence like learning and decision making.";
    }
    else {
        const responses = [
            "That's an interesting question! Unfortunately I have limited information on this specific topic. Can I help you with something else?",
            "I'm more specialized in programming and tech fields, but from what I know... [general answer]. Would you like more details?",
            "I don't have an exact answer for that right now, but I can help with programming and tech topics.",
            "That's outside my main area of expertise, but I'm constantly learning. Do you have any programming or web development questions?"
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

// Detect language of the message
function detectLanguage(text) {
    // Simple detection based on character ranges
    if (/[\u0600-\u06FF]/.test(text)) {
        return 'arabic';
    } else if (/[a-zA-Z]/.test(text)) {
        return 'english';
    }
    return 'unknown';
}


// Get general response based on language
function getGeneralResponse(message) {
    const lang = detectLanguage(message);
    
    if (lang === 'arabic') {
        const responses = [
            "هل يمكنك توضيح طلبك أكثر؟ كيف يمكنني مساعدتك اليوم؟",
            "أنا هنا لمساعدتك في البرمجة والمعلومات العامة. ما الذي تحتاجه؟",
            "هل تريد مساعدة في موضوع برمجة معين أو لديك سؤال عام؟",
            "كيف يمكنني خدمتك اليوم؟ يمكنني المساعدة في مواضيع التقنية والبرمجة."
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    } else {
        const responses = [
            "Could you clarify your request? How can I help you today?",
            "I'm here to help with programming and general knowledge. What do you need?",
            "Do you need help with a specific programming topic or have a general question?",
            "How can I assist you today? I can help with technology and programming topics."
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

        // Add user message to chat
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'user',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add bot message to chat
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add code message to chat
        function addCodeMessage(code, language) {
            const codeDiv = document.createElement('pre');
            codeDiv.className = 'code-editor';
            codeDiv.textContent = code;
            codeDiv.setAttribute('data-language', language);
            chatMessages.appendChild(codeDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add copy button
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-secondary';
            copyBtn.textContent = 'نسخ الكود';
            copyBtn.style.marginTop = '10px';
            copyBtn.onclick = function() {
                navigator.clipboard.writeText(code);
                copyBtn.textContent = 'تم النسخ!';
                setTimeout(() => {
                    copyBtn.textContent = 'نسخ الكود';
                }, 2000);
            };
            
            const container = document.createElement('div');
            container.className = 'bot-message';
            container.appendChild(copyBtn);
            chatMessages.appendChild(container);
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: '[CODE]',
                code: code,
                language: language,
                time: new Date().toLocaleTimeString()
            });
        }

        // Increment usage counter
        function incrementUsage() {
            if (currentUser && currentUser.plan !== 'enterprise') {
                userUsage++;
                localStorage.setItem('PixyAiUsage', userUsage);
                updateUsage();
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
            
            // Load usage from localStorage
            const savedUsage = localStorage.getItem('PixyAiUsage');
            if (savedUsage) {
                userUsage = parseInt(savedUsage);
                updateUsage();
            }
            
            // Check if usage should reset (new day)
            const lastUsageDate = localStorage.getItem('PixyAiUsageDate');
            const today = new Date().toDateString();
            
            if (lastUsageDate !== today) {
                userUsage = 0;
                localStorage.setItem('PixyAiUsage', '0');
                localStorage.setItem('PixyAiUsageDate', today);
                updateUsage();
            }
        });
    </script>
</body>
</html>
