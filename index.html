<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixyAi Pro - بوت كتابة الأكواد الذكي</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2d2e33;
            --secondary-color: #4f4f50;
            --accent-color: #494949be;
            --dark-color: #1a1a2e;
            --light-color: #f8f9fa;
            --success-color: #4cc9f0;
            --warning-color: #f8961e;
            --danger-color: #ef233c;
            --gray-color: #6c757d;
            --bg-gradient: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 15px 30px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .logo-icon {
            background: var(--accent-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-align: center;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.63);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-outline {
            background: transparent;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn-primary:hover {
            background: #a1a1a1;
            box-shadow: 0 8px 25px rgba(45, 38, 48, 0.4);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Main Content Layout */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Sidebar Styles */
        .sidebar {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--card-border);
            height: fit-content;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .sidebar-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .sidebar-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        /* User Info Styles */
        .user-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--bg-gradient);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            font-weight: bold;
            color: white;
        }

        .user-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-email {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .subscription-status {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .status-free {
            background: var(--gray-color);
        }

        .status-pro {
            background: linear-gradient(45deg, var(--accent-color), #f7f7f7);
        }

        .status-enterprise {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        }

        .usage-info {
            margin-top: 15px;
        }

        .usage-text {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), #f7f7f7);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        /* Language Tags */
        .language-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .language-tag {
            background: rgba(67, 97, 238, 0.2);
            border: 1px solid rgba(67, 97, 238, 0.3);
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* File Upload Styles */
        .file-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(0, 0, 0, 0.1);
        }

        .file-upload:hover {
            border-color: var(--accent-color);
            background: rgba(104, 102, 104, 0.637);
        }

        .file-upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .file-upload-text {
            margin-bottom: 5px;
        }

        .file-upload-subtext {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Uploaded Files List */
        .uploaded-files-list {
            list-style: none;
            margin-top: 15px;
        }

        .file-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(67, 97, 238, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-size: 14px;
            margin-bottom: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-meta {
            display: flex;
            gap: 10px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .file-actions {
            display: flex;
            gap: 5px;
        }

        /* Features List */
        .features-list {
            list-style: none;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .feature-item:last-child {
            border-bottom: none;
        }

        .feature-icon {
            color: var(--accent-color);
        }

        /* Chat Area Styles */
        .chat-area {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 0;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            height: 700px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-title {
            font-size: 18px;
            font-weight: 600;
        }

        .chat-tabs {
            display: flex;
            margin-right: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 5px;
        }

        .chat-tab {
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-tab.active {
            background: var(--accent-color);
            font-weight: 600;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: 18px;
            animation: fadeIn 0.3s ease;
            position: relative;
            line-height: 1.5;
        }

        .user-message {
            background: linear-gradient(135deg, var(--primary-color), #4895ef);
            margin-left: auto;
            border-bottom-right-radius: 5px;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.2);
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.1);
            margin-right: auto;
            border-bottom-left-radius: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
            text-align: left;
        }

        .user-message .message-time {
            text-align: right;
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
        }

        .chat-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.3);
        }

        .chat-input input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .send-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent-color);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.63);
        }

        .send-button:hover {
            background: #a1a1a1;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(45, 38, 48, 0.4);
        }

        /* Code Editor Styles */
        .code-editor {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-family: 'Tajawal', sans-serif;
        }

        .code-language {
            background: rgba(0, 0, 0, 0.3);
            padding: 3px 10px;
            border-radius: 50px;
            font-size: 12px;
            text-transform: uppercase;
        }

        .code-actions {
            display: flex;
            gap: 10px;
        }

        .code-action {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .code-action:hover {
            background: var(--accent-color);
        }

        /* Features Section */
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--card-border);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 20px;
            color: var(--accent-color);
            width: 70px;
            height: 70px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(104, 102, 104, 0.637);
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Pricing Section */
        .pricing-section {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 40px;
            border: 1px solid var(--card-border);
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .plan-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .plan-card.popular {
            border: 1px solid var(--accent-color);
            transform: scale(1.02);
        }

        .plan-card.popular::before {
            content: 'الأكثر شهرة';
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--accent-color);
            color: white;
            padding: 3px 10px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
        }

        .plan-name {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .plan-price {
            font-size: 40px;
            font-weight: 700;
            margin: 20px 0;
            color: white;
        }

        .plan-price small {
            font-size: 16px;
            font-weight: normal;
            color: var(--text-secondary);
        }

        .plan-features {
            list-style: none;
            margin: 30px 0;
            text-align: right;
        }

        .plan-features li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plan-features li::before {
            content: '✓';
            color: var(--success-color);
            font-weight: bold;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--dark-color);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(238, 241, 255, 0.3);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .form-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-footer a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .chat-area {
                order: 1;
                height: 600px;
                margin-bottom: 30px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .pricing-plans {
                grid-template-columns: 1fr;
            }
            
            .plan-card.popular {
                transform: none;
            }
            
            .modal-content {
                width: 90%;
                padding: 30px 20px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .mt-10 {
            margin-top: 10px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-10 {
            margin-bottom: 10px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <span>PixyAi Pro</span>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="showModal('loginModal')">
                    <i class="fas fa-sign-in-alt"></i> تسجيل الدخول
                </button>
                <button class="btn btn-primary" onclick="showModal('registerModal')">
                    <i class="fas fa-user-plus"></i> إنشاء حساب
                </button>
                <button class="btn btn-secondary hidden" id="logoutBtn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> تسجيل خروج
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="user-info hidden" id="userInfo">
                    <div class="user-avatar" id="userAvatar">م</div>
                    <h3 class="user-name" id="userName">مستخدم جديد</h3>
                    <p class="user-email" id="userEmail">user@example.com</p>
                    <div class="subscription-status status-free" id="userStatus">مجاني</div>
                    
                    <div class="usage-info">
                        <div class="usage-text">
                            <span>استخدام اليوم</span>
                            <span id="usageText">0/10 طلبات</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="usageProgress"></div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-code"></i> لغات البرمجة المدعومة
                    </h3>
                    <div class="language-tags">
                        <span class="language-tag">
                            <i class="fab fa-html5"></i> HTML
                        </span>
                        <span class="language-tag">
                            <i class="fab fa-css3-alt"></i> CSS
                        </span>
                        <span class="language-tag">
                            <i class="fas fa-code"></i> Lua
                        </span>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-file-upload"></i> رفع الملفات
                    </h3>
                    <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                        <div class="file-upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p class="file-upload-text">اسحب وأفلت الملف هنا أو انقر للرفع</p>
                        <p class="file-upload-subtext">يدعم: .lua, .html, .css</p>
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".lua,.html,.css" onchange="handleFileUpload(this)">
                </div>

                <div class="sidebar-section" id="uploadedFilesSection">
                    <h3 class="sidebar-title">
                        <i class="fas fa-folder-open"></i> الملفات المرفوعة
                    </h3>
                    <div id="uploadedFiles">
                        <p style="color: var(--text-secondary); text-align: center; font-size: 14px;">
                            لا توجد ملفات مرفوعة بعد
                        </p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-star"></i> المميزات
                    </h3>
                    <ul class="features-list">
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>كتابة أكواد ذكية</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>تعديل الأكواد</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>دعم +100K سطر</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>سرعة فائقة</span>
                        </li>
                        <li class="feature-item">
                            <i class="fas fa-check-circle feature-icon"></i>
                            <span>تحليل الأخطاء</span>
                        </li>
                    </ul>
                </div>
            </aside>

            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-header">
                    <div class="chat-tabs">
                        <div class="chat-tab active">المحادثة</div>
                        <div class="chat-tab">الأكواد</div>
                        <div class="chat-tab">التاريخ</div>
                        <div class="chat-tab" onclick="startQuizGame()"><i class="fas fa-gamepad"></i> لعبة أسئلة</div>
                    </div>
                    <h3 class="chat-title">
                        <i class="fas fa-robot"></i> PixyAi Pro
                    </h3>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot-message">
                        <div class="message-content">
                            مرحباً! أنا PixyAi Pro 🤖<br>
                            يمكنني مساعدتك في:<br>
                            • كتابة أكواد Lua, HTML, CSS<br>
                            • تعديل وتحسين الأكواد<br>
                            • كتابة أكثر من 100,000 سطر بسرعة<br>
                            • تحليل وإصلاح الأخطاء
                        </div>
                        <div class="message-time">الآن</div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" id="messageInput" placeholder="اكتب طلبك هنا... مثل: اكتب لي موقع HTML بسيط">
                        <button class="send-button" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>


<!-- أضف هذا قبل نهاية container -->
<div class="modal" id="quizModal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title"><i class="fas fa-trophy"></i> لعبة الأسئلة المتطورة</h2>
            <p class="modal-subtitle">اختر الإعدادات واستمتع بتجربة لعب مميزة!</p>
        </div>
        <div class="quiz-settings">
            <div class="settings-grid">
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-users"></i> عدد اللاعبين</label>
                    <select id="playersCount" class="form-input premium-select">
                        <option value="1">🎮 1 لاعب</option>
                        <option value="2">👥 2 لاعبين</option>
                        <option value="3">👨‍👩‍👦 3 لاعبين</option>
                        <option value="4">👨‍👩‍👧‍👦 4 لاعبين</option>
                        <option value="5">🏆 5 لاعبين</option>
                        <option value="6">⭐ 6 لاعبين</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-star"></i> نقاط الفوز</label>
                    <select id="winningPoints" class="form-input premium-select">
                        <option value="3">⚡ 3 نقاط - سريع</option>
                        <option value="5">🎯 5 نقاط - قصير</option>
                        <option value="10">🏅 10 نقاط - متوسط</option>
                        <option value="15">🏆 15 نقطة - طويل</option>
                        <option value="20">👑 20 نقطة - ماراثون</option>
                        <option value="25">💎 25 نقطة - أسطوري</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-list"></i> الفئة</label>
                    <select id="quizCategory" class="form-input premium-select">
                        <option value="general">🌍 عامة</option>
                        <option value="science">🔬 علوم</option>
                        <option value="history">📚 تاريخ</option>
                        <option value="sports">⚽ رياضة</option>
                        <option value="entertainment">🎬 ترفيه</option>
                        <option value="technology">💻 تكنولوجيا</option>
                        <option value="geography">🗺️ جغرافيا</option>
                        <option value="islamic">🕌 إسلامية</option>
                        <option value="literature">📖 أدب</option>
                        <option value="math">🔢 رياضيات</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-chart-line"></i> مستوى الصعوبة</label>
                    <select id="quizDifficulty" class="form-input premium-select">
                        <option value="easy">🟢 سهل - للمبتدئين</option>
                        <option value="medium">🟡 متوسط - للخبراء</option>
                        <option value="hard">🔴 صعب - للمحترفين</option>
                        <option value="expert">💜 خبير - للأساطير</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-clock"></i> وقت الإجابة</label>
                    <select id="answerTime" class="form-input premium-select">
                        <option value="0">♾️ بدون حد زمني</option>
                        <option value="10">⏰ 10 ثواني</option>
                        <option value="15">⏱️ 15 ثانية</option>
                        <option value="20">⏲️ 20 ثانية</option>
                        <option value="30">🕐 30 ثانية</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-volume-up"></i> المؤثرات الصوتية</label>
                    <select id="soundEffects" class="form-input premium-select">
                        <option value="on">🔊 مفعلة</option>
                        <option value="off">🔇 معطلة</option>
                    </select>
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-primary premium-btn" onclick="startQuiz()">
                    <i class="fas fa-play"></i> بدء اللعبة
                </button>
                <button class="btn btn-secondary" onclick="closeModal('quizModal')">
                    <i class="fas fa-times"></i> إلغاء
                </button>
            </div>
        </div>
    </div>
</div>

<!-- أضف هذا قبل نهاية container -->
<div class="modal" id="quizGameModal">
    <div class="modal-content" style="max-width: 900px;">
        <div class="quiz-game-container">
            <div class="quiz-header">
                <div class="quiz-timer" id="quizTimer" style="display: none;">
                    <i class="fas fa-stopwatch"></i>
                    <span id="timeLeft">15</span>
                </div>
                <h2 id="quizQuestion" class="question-text">السؤال يظهر هنا</h2>
                <div class="quiz-progress">
                    <div class="progress-info">
                        <span id="quizProgress">السؤال 1 من 10</span>
                        <span id="categoryDisplay" class="category-badge">عامة</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="quizProgressBar"></div>
                    </div>
                </div>
            </div>
            
            <div class="quiz-options" id="quizOptions">
                <!-- الخيارات تظهر هنا -->
            </div>
            
            <div class="quiz-players" id="quizPlayers">
                <!-- معلومات اللاعبين تظهر هنا -->
            </div>
            
            <div class="quiz-stats" id="quizStats">
                <div class="stat-item">
                    <i class="fas fa-check-circle"></i>
                    <span>صحيحة: <span id="correctAnswers">0</span></span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-times-circle"></i>
                    <span>خاطئة: <span id="wrongAnswers">0</span></span>
                </div>
                <div class="stat-item">
                    <i class="fas fa-percentage"></i>
                    <span>النسبة: <span id="successRate">0%</span></span>
                </div>
            </div>
            
            <div class="quiz-actions">
                <button class="btn btn-secondary" onclick="pauseQuiz()" id="pauseBtn">
                    <i class="fas fa-pause"></i> إيقاف مؤقت
                </button>
                <button class="btn btn-danger" onclick="endQuiz()">
                    <i class="fas fa-stop"></i> إنهاء اللعبة
                </button>
                <button class="btn btn-primary hidden" id="nextQuestionBtn" onclick="nextQuestion()">
                    <i class="fas fa-arrow-right"></i> السؤال التالي
                </button>
            </div>
        </div>
    </div>
</div>

<!-- نافذة النتيجة النهائية -->
<div class="modal" id="resultsModal">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header results-header">
            <h2 class="modal-title"><i class="fas fa-trophy"></i> النتائج النهائية</h2>
        </div>
        <div class="results-content" id="resultsContent">
            <!-- النتائج تظهر هنا -->
        </div>
        <div class="form-actions">
            <button class="btn btn-primary" onclick="startQuizGame(); closeModal('resultsModal')">
                <i class="fas fa-redo"></i> لعبة جديدة
            </button>
            <button class="btn btn-secondary" onclick="closeModal('resultsModal')">
                <i class="fas fa-times"></i> إغلاق
            </button>
        </div>
    </div>
</div>

<!-- أضف هذا في قسم الـ style -->
<!-- أضف هذا في قسم الـ style -->
<style>
    .settings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        padding: 25px;
    }
    
    .quiz-settings {
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        border-radius: 15px;
        backdrop-filter: blur(10px);
    }
    
    .form-group {
        background: rgba(255,255,255,0.08);
        padding: 20px;
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.1);
        transition: all 0.3s ease;
    }
    
    .form-group:hover {
        background: rgba(255,255,255,0.12);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    .form-label {
        display: block;
        margin-bottom: 10px;
        font-weight: 600;
        color: #fff;
        font-size: 14px;
    }
    
    .form-label i {
        margin-left: 8px;
        color: #4facfe;
    }
    
    .premium-select {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 8px;
        background: rgba(255,255,255,0.1);
        color: #fff;
        font-size: 14px;
        transition: all 0.3s ease;
    }
    
    .premium-select:focus {
        border-color: #4facfe;
        background: rgba(255,255,255,0.15);
        outline: none;
        box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
    }
    
    .premium-select option {
        background: #2a2a2a;
        color: #fff;
        padding: 10px;
    }
    
    .quiz-game-container {
        padding: 25px;
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        border-radius: 15px;
        backdrop-filter: blur(10px);
    }
    
    .quiz-header {
        text-align: center;
        margin-bottom: 30px;
        position: relative;
    }
    
    .quiz-timer {
        position: absolute;
        top: -10px;
        right: 0;
        background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    .question-text {
        font-size: 24px;
        margin-bottom: 20px;
        color: #fff;
        line-height: 1.4;
        padding: 20px;
        background: rgba(255,255,255,0.1);
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.2);
    }
    
    .quiz-progress {
        margin-bottom: 25px;
    }
    
    .progress-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .category-badge {
        background: linear-gradient(135deg, #00f2fe, #00f2fe);
        color: white;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 600;
    }
    
    .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(255,255,255,0.2);
        border-radius: 10px;
        overflow: hidden;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #4facfe, #00f2fe);
        border-radius: 10px;
        transition: width 0.5s ease;
    }
    
    .quiz-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
    }
    
    @media (max-width: 600px) {
        .quiz-options {
            grid-template-columns: 1fr;
        }
    }
    
    .quiz-option {
        background: rgba(255,255,255,0.1);
        border: 2px solid rgba(255,255,255,0.2);
        padding: 18px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-align: center;
        font-weight: 500;
        position: relative;
        overflow: hidden;
    }
    
    .quiz-option::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(79, 172, 254, 0.3), rgba(0, 242, 254, 0.3));
        transition: left 0.3s;
    }
    
    .quiz-option:hover::before {
        left: 0;
    }
    
    .quiz-option:hover {
        background: rgba(255,255,255,0.2);
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        border-color: #4facfe;
    }
    
    .quiz-option.correct {
        background: linear-gradient(135deg, rgba(76, 201, 240, 0.4), rgba(0, 242, 254, 0.4));
        border-color: #4facfe;
        animation: correctPulse 0.6s ease;
    }
    
    .quiz-option.wrong {
        background: linear-gradient(135deg, rgba(239, 35, 60, 0.4), rgba(255, 107, 107, 0.4));
        border-color: #ff6b6b;
        animation: wrongShake 0.6s ease;
    }
    
    @keyframes correctPulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    @keyframes wrongShake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        75% { transform: translateX(5px); }
    }
    
    .quiz-players {
        display: flex;
        justify-content: space-around;
        margin-bottom: 25px;
        flex-wrap: wrap;
        gap: 15px;
    }
    
    .quiz-player {
        background: rgba(255,255,255,0.1);
        padding: 18px;
        border-radius: 12px;
        text-align: center;
        min-width: 140px;
        border: 2px solid transparent;
        transition: all 0.3s ease;
    }
    
    .quiz-player.active {
        border-color: #4facfe;
        background: rgba(79, 172, 254, 0.2);
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
    }
    
    .player-name {
        font-weight: bold;
        margin-bottom: 8px;
        font-size: 14px;
    }
    
    .player-score {
        font-size: 28px;
        color: #4facfe;
        font-weight: 700;
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .quiz-stats {
        display: flex;
        justify-content: center;
        gap: 25px;
        margin-bottom: 25px;
        flex-wrap: wrap;
    }
    
    .stat-item {
        background: rgba(255,255,255,0.1);
        padding: 12px 20px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 600;
    }
    
    .stat-item i {
        font-size: 16px;
    }
    
    .stat-item:nth-child(1) i { color: #4facfe; }
    .stat-item:nth-child(2) i { color: #ff6b6b; }
    .stat-item:nth-child(3) i { color: #feca57; }
    
    .quiz-actions {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }
    
    .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
        font-size: 14px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        min-width: 120px;
        justify-content: center;
    }
    
    .btn i {
        font-size: 16px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #4facfe, #00f2fe);
        color: white;
    }
    
    .btn-secondary {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 1px solid rgba(255,255,255,0.3);
    }
    
    .btn-danger {
        background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        color: white;
    }
    
    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    .premium-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        font-size: 16px;
        padding: 15px 30px;
        position: relative;
        overflow: hidden;
    }
    
    .premium-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #764ba2, #667eea);
        transition: left 0.5s;
    }
    
    .premium-btn:hover::before {
        left: 0;
    }
    
    .premium-btn span {
        position: relative;
        z-index: 1;
    }
    
    .form-actions {
        padding: 25px;
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }
    
    .results-header {
        background: linear-gradient(135deg, #667eea, #764ba2);
    }
    
    .results-content {
        padding: 30px;
        text-align: center;
    }
    
    .winner-announcement {
        font-size: 24px;
        font-weight: 700;
        color: #4facfe;
        margin-bottom: 20px;
        animation: celebration 1s ease-in-out;
    }
    
    @keyframes celebration {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }
    
    .final-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }
    
    .final-stat {
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }
    
    .hidden {
        display: none !important;
    }
    
    @media (max-width: 768px) {
        .settings-grid {
            grid-template-columns: 1fr;
            padding: 20px;
        }
        
        .quiz-game-container {
            padding: 20px;
        }
        
        .question-text {
            font-size: 20px;
            padding: 15px;
        }
        
        .quiz-players {
            justify-content: center;
        }
        
        .quiz-stats {
            flex-direction: column;
            align-items: center;
        }
        
        .quiz-actions {
            flex-direction: column;
        }
        
        .btn {
            width: 100%;
            max-width: 250px;
        }
    }
</style>

<!-- أضف هذا في قسم الـ script -->
<script>
    // متغيرات اللعبة المتطورة
    let quizQuestions = [];
    let currentQuestionIndex = 0;
    let quizPlayers = [];
    let currentPlayerIndex = 0;
    let winningPoints = 10;
    let quizCategory = 'general';
    let quizDifficulty = 'easy';
    let answerTimeLimit = 0;
    let soundEffectsEnabled = true;
    let gameTimer = null;
    let timeLeft = 0;
    let gamePaused = false;
    let correctAnswersCount = 0;
    let wrongAnswersCount = 0;
    let gameStartTime = null;
    
    // أسئلة اللعبة الشاملة
    const quizData = {
        general: [
            {
                question: "ما هي عاصمة فرنسا؟",
                options: ["لندن", "باريس", "روما", "برلين"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "كم عدد الكواكب في النظام الشمسي؟",
                options: ["7", "8", "9", "10"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هو أطول نهر في العالم؟",
                options: ["النيل", "الأمازون", "الميسيسيبي", "الدانوب"],
                answer: 0,
                difficulty: "medium"
            },
            {
                question: "في أي قارة تقع دولة البرازيل؟",
                options: ["آسيا", "أفريقيا", "أمريكا الجنوبية", "أوروبا"],
                answer: 2,
                difficulty: "easy"
            },
            {
                question: "ما هو أكبر محيط في العالم؟",
                options: ["الأطلسي", "الهندي", "الهادئ", "المتجمد الشمالي"],
                answer: 2,
                difficulty: "medium"
            },
            {
                question: "كم عدد القارات في العالم؟",
                options: ["5", "6", "7", "8"],
                answer: 2,
                difficulty: "easy"
            }
        ],
        science: [
            {
                question: "ما هو العنصر الكيميائي الذي رمزه 'O'؟",
                options: ["ذهب", "أكسجين", "فضة", "حديد"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هي وحدة قياس التيار الكهربائي؟",
                options: ["فولت", "أمبير", "واط", "أوم"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "ما هو أسرع حيوان في العالم؟",
                options: ["الفهد", "النسر", "الدولفين", "الأرنب"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "كم عدد العظام في جسم الإنسان البالغ؟",
                options: ["206", "215", "198", "220"],
                answer: 0,
                difficulty: "hard"
            },
            {
                question: "ما هو الغاز الأكثر وفرة في الغلاف الجوي؟",
                options: ["الأكسجين", "النيتروجين", "ثاني أكسيد الكربون", "الهيدروجين"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "ما هي المادة الأصلب الموجودة طبيعياً؟",
                options: ["الحديد", "الألماس", "الذهب", "البلاتين"],
                answer: 1,
                difficulty: "easy"
            }
        ],
        history: [
            {
                question: "في أي عام هبط الإنسان على القمر لأول مرة؟",
                options: ["1965", "1969", "1972", "1975"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "من هو أول رئيس للولايات المتحدة الأمريكية؟",
                options: ["توماس جيفرسون", "جورج واشنطن", "أبراهام لينكولن", "جون آدامز"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "في أي عام انتهت الحرب العالمية الثانية؟",
                options: ["1944", "1945", "1946", "1943"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "من بنى الأهرامات الثلاثة في الجيزة؟",
                options: ["الرومان", "الإغريق", "المصريون القدماء", "البابليون"],
                answer: 2,
                difficulty: "easy"
            },
            {
                question: "ما هي أقدم حضارة في التاريخ؟",
                options: ["المصرية", "السومرية", "الصينية", "الهندية"],
                answer: 1,
                difficulty: "hard"
            }
        ],
        sports: [
            {
                question: "في أي رياضة يستخدم المضرب والكرة الصفراء؟",
                options: ["كرة القدم", "التنس", "الجولف", "الكريكيت"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "كم عدد اللاعبين في فريق كرة القدم؟",
                options: ["10", "11", "12", "9"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "في أي دولة أقيمت أولمبياد 2020؟",
                options: ["الصين", "اليابان", "كوريا الجنوبية", "أستراليا"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "ما هي الرياضة التي تُلعب في ويمبلدون؟",
                options: ["كرة القدم", "التنس", "الجولف", "الكريكيت"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "كم عدد الحلقات في شعار الألعاب الأولمبية؟",
                options: ["4", "5", "6", "7"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "في أي رياضة يُستخدم مصطلح 'هول إن وان'؟",
                options: ["التنس", "البيسبول", "الجولف", "كرة السلة"],
                answer: 2,
                difficulty: "medium"
            }
        ],
        entertainment: [
            {
                question: "من هو ملك البوب؟",
                options: ["مايكل جاكسون", "إلتون جون", "جاستن بيبر", "برونو مارس"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "ما هو اسم المسلسل الكوري الشهير عن الألعاب؟",
                options: ["لعبة الحبار", "الطائر الأزرق", "ملكة الجنوب", "الورثة"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "من أخرج فيلم 'تايتانيك'؟",
                options: ["ستيفن سبيلبرغ", "جيمس كاميرون", "مارتن سكورسيزي", "كريستوفر نولان"],
                answer: 1,
                difficulty: "medium"
            },
            {
                question: "ما هو اسم الساحر الشهير في سلسلة كتب وأفلام هاري بوتر؟",
                options: ["هاري بوتر", "رون ويزلي", "هيرمايون غرانجر", "دمبلدور"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "في أي عام تم إنتاج فيلم 'أفاتار' الأول؟",
                options: ["2007", "2008", "2009", "2010"],
                answer: 2,
                difficulty: "hard"
            }
        ],
        technology: [
            {
                question: "من هو مؤسس شركة مايكروسوفت؟",
                options: ["ستيف جوبز", "بيل غيتس", "مارك زوكربيرغ", "إيلون ماسك"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هو اختصار 'WWW'؟",
                options: ["World Wide Web", "World Wild Web", "World War Web", "World Web Wide"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "في أي عام تم إطلاق أول iPhone؟",
                options: ["2005", "2006", "2007", "2008"],
                answer: 2,
                difficulty: "medium"
            },
            {
                question: "ما هو اسم أول شبكة اجتماعية على الإنترنت؟",
                options: ["فيسبوك", "تويتر", "SixDegrees", "ماي سبيس"],
                answer: 2,
                difficulty: "hard"
            },
            {
                question: "ما هي وحدة قياس سرعة المعالج؟",
                options: ["بايت", "هرتز", "بت", "وات"],
                answer: 1,
                difficulty: "medium"
            }
        ],
        geography: [
            {
                question: "ما هي أكبر دولة في العالم من حيث المساحة؟",
                options: ["الصين", "كندا", "روسيا", "الولايات المتحدة"],
                answer: 2,
                difficulty: "easy"
            },
            {
                question: "ما هي عاصمة أستراليا؟",
                options: ["سيدني", "ملبورن", "كانبرا", "بريسبان"],
                answer: 2,
                difficulty: "medium"
            },
            {
                question: "في أي قارة تقع دولة المغرب؟",
                options: ["آسيا", "أفريقيا", "أوروبا", "أمريكا الشمالية"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هو أعلى جبل في العالم؟",
                options: ["K2", "إيفرست", "كانشينجونغا", "لوتسي"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هي أصغر دولة في العالم؟",
                options: ["موناكو", "ناورو", "الفاتيكان", "ليختنشتاين"],
                answer: 2,
                difficulty: "medium"
            }
        ],
        islamic: [
            {
                question: "كم عدد أركان الإسلام؟",
                options: ["4", "5", "6", "7"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "في أي عام هجري تم فتح مكة؟",
                options: ["6", "7", "8", "9"],
                answer: 2,
                difficulty: "medium"
            },
            {
                question: "كم عدد سور القرآن الكريم؟",
                options: ["110", "114", "115", "120"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هي أطول سورة في القرآن الكريم؟",
                options: ["البقرة", "آل عمران", "النساء", "المائدة"],
                answer: 0,
                difficulty: "easy"
            },
            {
                question: "في أي مدينة وُلد الرسول محمد صلى الله عليه وسلم؟",
                options: ["المدينة", "مكة", "الطائف", "جدة"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "كم عدد الصلوات المفروضة في اليوم؟",
                options: ["3", "4", "5", "6"],
                answer: 2,
                difficulty: "easy"
            }
        ],
        literature: [
            {
                question: "من كتب رواية 'مئة عام من العزلة'؟",
                options: ["غابرييل غارسيا ماركيز", "خورخي لويس بورخيس", "إيزابيل الليندي", "ماريو فارغاس يوسا"],
                answer: 0,
                difficulty: "hard"
            },
            {
                question: "من هو شاعر الرسول صلى الله عليه وسلم؟",
                options: ["حسان بن ثابت", "كعب بن مالك", "عبد الله بن رواحة", "الأعشى"],
                answer: 0,
                difficulty: "medium"
            },
            {
                question: "من كتب رواية 'الأسود يليق بك'؟",
                options: ["أحلام مستغانمي", "نوال السعداوي", "فاطمة المرنيسي", "رضوى عاشور"],
                answer: 0,
                difficulty: "medium"
            },
            {
                question: "ما هو اسم ملحمة هوميروس الشهيرة؟",
                options: ["الإلياذة", "الأوديسة", "الإنيادة", "المهابهاراتا"],
                answer: 0,
                difficulty: "medium"
            }
        ],
        math: [
            {
                question: "ما هو ناتج 8 × 7؟",
                options: ["54", "56", "58", "60"],
                answer: 1,
                difficulty: "easy"
            },
            {
                question: "ما هو الجذر التربيعي للعدد 64؟",
                options: ["6", "7", "8", "9"],
                answer: 2,
                difficulty: "easy"
            },
            {
                question: "ما هي قيمة π (باي) تقريباً؟",
                options: ["3.14", "3.16", "3.18", "3.20"],
                answer: 0,
                difficulty: "medium"
            },
            {
                question: "كم عدد الأضلاع في الشكل الثماني؟",
                options: ["6", "7", "8", "9"],
                answer: 2,
                difficulty: "easy"
            },
            {
                question: "ما هو ناتج 15% من 200؟",
                options: ["25", "30", "35", "40"],
                answer: 1,
                difficulty: "medium"
            }
        ]
    };
    
    // أسماء اللاعبين العشوائية
    const playerNames = [
        "أحمد المتفوق", "فاطمة الذكية", "محمد العبقري", "عائشة المبدعة",
        "علي الخبير", "خديجة الماهرة", "عمر الفطين", "زينب الألمعية",
        "حسن الذكي", "مريم الفهيمة", "يوسف العارف", "سارة الحكيمة"
    ];

     // المؤثرات الصوتية
    function playSound(type) {
        if (!soundEffectsEnabled) return;
        
        // في تطبيق حقيقي، يمكن تشغيل ملفات صوتية
        if (type === 'correct') {
            console.log('🎵 صوت إجابة صحيحة');
        } else if (type === 'wrong') {
            console.log('🎵 صوت إجابة خاطئة');
        } else if (type === 'win') {
            console.log('🎵 صوت فوز');
        } else if (type === 'tick') {
            console.log('🎵 صوت تكتكة');
        }
    }
    
    // بدء لعبة الأسئلة
    function startQuizGame() {
        showModal('quizModal');
        resetGameStats();
    }
    
    
      // إعادة تعيين إحصائيات اللعبة
    function resetGameStats() {
        correctAnswersCount = 0;
        wrongAnswersCount = 0;
        currentQuestionIndex = 0;
        currentPlayerIndex = 0;
        gamePaused = false;
        gameStartTime = null;
    }
    
    // بدء اللعبة مع الإعدادات المختارة
    function startQuiz() {
        const playersCount = parseInt(document.getElementById('playersCount').value);
        winningPoints = parseInt(document.getElementById('winningPoints').value);
        quizCategory = document.getElementById('quizCategory').value;
        quizDifficulty = document.getElementById('quizDifficulty').value;
        answerTimeLimit = parseInt(document.getElementById('answerTime').value);
        soundEffectsEnabled = document.getElementById('soundEffects').value === 'on';
        
        // إنشاء اللاعبين مع أسماء عشوائية
        quizPlayers = [];
        const shuffledNames = shuffleArray([...playerNames]);
        
        for (let i = 0; i < playersCount; i++) {
            quizPlayers.push({
                name: shuffledNames[i] || `اللاعب ${i + 1}`,
                score: 0,
                correctAnswers: 0,
                wrongAnswers: 0,
                averageTime: 0
            });
        }
        
        // تحضير الأسئلة
        prepareQuestions();
        
        // إخفاء نموذج الإعدادات وإظهار نموذج اللعبة
        closeModal('quizModal');
        showModal('quizGameModal');
        
        // بدء السؤال الأول
        gameStartTime = new Date();
        currentQuestionIndex = 0;
        currentPlayerIndex = 0;
        showQuestion();
        updateGameStats();
    }
    
    // تحضير الأسئلة حسب الفئة والمستوى
    function prepareQuestions() {
        let allQuestions = [...quizData[quizCategory]];
        
        // تصفية الأسئلة حسب مستوى الصعوبة
        if (quizDifficulty !== 'expert') {
            allQuestions = allQuestions.filter(q => {
                if (quizDifficulty === 'easy') return q.difficulty === 'easy';
                if (quizDifficulty === 'medium') return q.difficulty === 'easy' || q.difficulty === 'medium';
                if (quizDifficulty === 'hard') return q.difficulty !== 'expert';
                return true;
            });
        }
        
        // خلط الأسئلة عشوائياً
        quizQuestions = shuffleArray(allQuestions);
        
        // تحديد عدد الأسئلة حسب الصعوبة
        let questionCount = 10;
        if (quizDifficulty === 'easy') questionCount = 8;
        else if (quizDifficulty === 'medium') questionCount = 12;
        else if (quizDifficulty === 'hard') questionCount = 15;
        else if (quizDifficulty === 'expert') questionCount = 20;
        
        quizQuestions = quizQuestions.slice(0, Math.min(questionCount, quizQuestions.length));
    }
    
    // عرض السؤال الحالي
    function showQuestion() {
        if (gamePaused) return;
        
        const currentQuestion = quizQuestions[currentQuestionIndex];
        
        // عرض السؤال
        document.getElementById('quizQuestion').textContent = currentQuestion.question;
        
        // عرض تقدم اللعبة
        document.getElementById('quizProgress').textContent = 
            `السؤال ${currentQuestionIndex + 1} من ${quizQuestions.length}`;
        document.getElementById('quizProgressBar').style.width = 
            `${((currentQuestionIndex + 1) / quizQuestions.length) * 100}%`;
        
        // عرض الفئة
        const categoryNames = {
            'general': '🌍 عامة',
            'science': '🔬 علوم',
            'history': '📚 تاريخ',
            'sports': '⚽ رياضة',
            'entertainment': '🎬 ترفيه',
            'technology': '💻 تكنولوجيا',
            'geography': '🗺️ جغرافيا',
            'islamic': '🕌 إسلامية',
            'literature': '📖 أدب',
            'math': '🔢 رياضيات'
        };
        document.getElementById('categoryDisplay').textContent = categoryNames[quizCategory];
        
        // عرض الخيارات
        const optionsContainer = document.getElementById('quizOptions');
        optionsContainer.innerHTML = '';
        
        currentQuestion.options.forEach((option, index) => {
            const optionElement = document.createElement('div');
            optionElement.className = 'quiz-option';
            optionElement.textContent = option;
            optionElement.onclick = function() {
                if (!gamePaused) checkAnswer(index);
            };
            optionsContainer.appendChild(optionElement);
        });
        
        // عرض معلومات اللاعبين
        updatePlayersDisplay();
        
        // إخفاء زر السؤال التالي
        document.getElementById('nextQuestionBtn').classList.add('hidden');
        
        // بدء العد التنازلي إذا كان مفعلاً
        if (answerTimeLimit > 0) {
            startTimer();
        } else {
            document.getElementById('quizTimer').style.display = 'none';
        }
    }
    
    // بدء العد التنازلي
    function startTimer() {
        const timerElement = document.getElementById('quizTimer');
        const timeLeftElement = document.getElementById('timeLeft');
        
        timerElement.style.display = 'block';
        timeLeft = answerTimeLimit;
        timeLeftElement.textContent = timeLeft;
        
        if (gameTimer) clearInterval(gameTimer);
        
        gameTimer = setInterval(() => {
            if (gamePaused) return;
            
            timeLeft--;
            timeLeftElement.textContent = timeLeft;
            
            if (timeLeft <= 5) {
                timerElement.style.animation = 'pulse 0.5s infinite';
                playSound('tick');
            }
            
            if (timeLeft <= 0) {
                clearInterval(gameTimer);
                timeOut();
            }
        }, 1000);
    }
    
    // انتهاء الوقت
    function timeOut() {
        const options = document.querySelectorAll('.quiz-option');
        options.forEach(option => {
            option.style.pointerEvents = 'none';
            option.style.opacity = '0.5';
        });
        
        // إظهار الإجابة الصحيحة
        const currentQuestion = quizQuestions[currentQuestionIndex];
        options[currentQuestion.answer].classList.add('correct');
        
        // تحديث الإحصائيات
        wrongAnswersCount++;
        quizPlayers[currentPlayerIndex].wrongAnswers++;
        
        // تبديل اللاعب
        currentPlayerIndex = (currentPlayerIndex + 1) % quizPlayers.length;
        
        // عرض زر السؤال التالي
        setTimeout(() => {
            document.getElementById('nextQuestionBtn').classList.remove('hidden');
        }, 1500);
        
        updatePlayersDisplay();
        updateGameStats();
        playSound('wrong');
    }
    
    // التحقق من الإجابة
    function checkAnswer(selectedIndex) {
        if (gameTimer) clearInterval(gameTimer);
        
        const currentQuestion = quizQuestions[currentQuestionIndex];
        const options = document.querySelectorAll('.quiz-option');
        
        // تعطيل جميع الخيارات
        options.forEach(option => {
            option.style.pointerEvents = 'none';
        });
        
        // إخفاء المؤقت
        document.getElementById('quizTimer').style.display = 'none';
        
        // تحديد الإجابة الصحيحة والخاطئة
        options[currentQuestion.answer].classList.add('correct');
        if (selectedIndex !== currentQuestion.answer) {
            options[selectedIndex].classList.add('wrong');
        }
        
        // تحديث النقاط والإحصائيات
        if (selectedIndex === currentQuestion.answer) {
            quizPlayers[currentPlayerIndex].score++;
            quizPlayers[currentPlayerIndex].correctAnswers++;
            correctAnswersCount++;
            playSound('correct');
            
            // التحقق إذا وصل اللاعب لنقاط الفوز
            if (quizPlayers[currentPlayerIndex].score >= winningPoints) {
                setTimeout(() => {
                    endQuiz();
                }, 1500);
                return;
            }
        } else {
            quizPlayers[currentPlayerIndex].wrongAnswers++;
            wrongAnswersCount++;
            playSound('wrong');
        }
        
        // تبديل اللاعب
        currentPlayerIndex = (currentPlayerIndex + 1) % quizPlayers.length;
        
        // عرض زر السؤال التالي
        setTimeout(() => {
            document.getElementById('nextQuestionBtn').classList.remove('hidden');
        }, 1500);
        
        updatePlayersDisplay();
        updateGameStats();
    }
    
    // الانتقال للسؤال التالي
    function nextQuestion() {
        currentQuestionIndex++;
        
        if (currentQuestionIndex < quizQuestions.length) {
            showQuestion();
        } else {
            endQuiz();
        }
    }
    
    // إيقاف/استئناف اللعبة
    function pauseQuiz() {
        const pauseBtn = document.getElementById('pauseBtn');
        
        if (gamePaused) {
            gamePaused = false;
            pauseBtn.innerHTML = '<i class="fas fa-pause"></i> إيقاف مؤقت';
            if (answerTimeLimit > 0 && timeLeft > 0) {
                startTimer();
            }
        } else {
            gamePaused = true;
            pauseBtn.innerHTML = '<i class="fas fa-play"></i> استئناف';
            if (gameTimer) clearInterval(gameTimer);
        }
    }
    
    // تحديث عرض معلومات اللاعبين
    function updatePlayersDisplay() {
        const playersContainer = document.getElementById('quizPlayers');
        playersContainer.innerHTML = '';
        
        quizPlayers.forEach((player, index) => {
            const playerElement = document.createElement('div');
            playerElement.className = `quiz-player ${index === currentPlayerIndex ? 'active' : ''}`;
            
            const successRate = player.correctAnswers + player.wrongAnswers > 0 ? 
                Math.round((player.correctAnswers / (player.correctAnswers + player.wrongAnswers)) * 100) : 0;
            
            playerElement.innerHTML = `
                <div class="player-name">${player.name}</div>
                <div class="player-score">${player.score}</div>
                <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">
                    ✅ ${player.correctAnswers} | ❌ ${player.wrongAnswers} | 📊 ${successRate}%
                </div>
            `;
            
            playersContainer.appendChild(playerElement);
        });
    }
    
    // تحديث إحصائيات اللعبة
    function updateGameStats() {
        document.getElementById('correctAnswers').textContent = correctAnswersCount;
        document.getElementById('wrongAnswers').textContent = wrongAnswersCount;
        
        const totalAnswers = correctAnswersCount + wrongAnswersCount;
        const successRate = totalAnswers > 0 ? Math.round((correctAnswersCount / totalAnswers) * 100) : 0;
        document.getElementById('successRate').textContent = successRate + '%';
    }
    
    // إنهاء اللعبة وعرض النتائج
    function endQuiz(customMessage) {
        if (gameTimer) clearInterval(gameTimer);
        
        // إغلاق نافذة اللعبة
        closeModal('quizGameModal');
        
        // تحديد الفائز أو المتعادلين
        let winners = [];
        let maxScore = Math.max(...quizPlayers.map(p => p.score));
        
        // البحث عن الفائزين
        if (maxScore >= winningPoints) {
            winners = quizPlayers.filter(p => p.score >= winningPoints);
        } else {
            winners = quizPlayers.filter(p => p.score === maxScore);
        }
        
        // حساب مدة اللعبة
        const gameEndTime = new Date();
        const gameDuration = gameStartTime ? Math.round((gameEndTime - gameStartTime) / 1000) : 0;
        const minutes = Math.floor(gameDuration / 60);
        const seconds = gameDuration % 60;
        
        // عرض النتائج
        displayResults(winners, maxScore, minutes, seconds, customMessage);
        
        playSound('win');
    }
    
    // عرض نافذة النتائج
    function displayResults(winners, maxScore, minutes, seconds, customMessage) {
        const resultsContent = document.getElementById('resultsContent');
        
        let winnerText = '';
        if (customMessage) {
            winnerText = customMessage;
        } else if (winners.length === 1) {
            winnerText = `🎉 مبروك ${winners[0].name}! 
                        <br>أنت الفائز بـ ${maxScore} نقطة! 🏆`;
        } else if (winners.length > 1) {
            winnerText = `🤝 تعادل بين: ${winners.map(w => w.name).join(' و ')}
                        <br>بـ ${maxScore} نقطة لكل منهم! 🏆`;
        } else {
            winnerText = `🎮 انتهت اللعبة!
                        <br>أعلى نقاط: ${maxScore} نقطة 📊`;
        }
        
        const totalQuestions = currentQuestionIndex;
        const overallSuccessRate = totalQuestions > 0 ? 
            Math.round((correctAnswersCount / totalQuestions) * 100) : 0;
        
        resultsContent.innerHTML = `
            <div class="winner-announcement">${winnerText}</div>
            
            <div class="final-stats">
                <div class="final-stat">
                    <div style="font-size: 24px; color: #4facfe;">⏱️</div>
                    <div>مدة اللعبة</div>
                    <div style="font-weight: bold;">${minutes}:${seconds.toString().padStart(2, '0')}</div>
                </div>
                <div class="final-stat">
                    <div style="font-size: 24px; color: #4facfe;">❓</div>
                    <div>إجمالي الأسئلة</div>
                    <div style="font-weight: bold;">${totalQuestions}</div>
                </div>
                <div class="final-stat">
                    <div style="font-size: 24px; color: #4facfe;">✅</div>
                    <div>إجابات صحيحة</div>
                    <div style="font-weight: bold;">${correctAnswersCount}</div>
                </div>
                <div class="final-stat">
                    <div style="font-size: 24px; color: #4facfe;">📊</div>
                    <div>معدل النجاح</div>
                    <div style="font-weight: bold;">${overallSuccessRate}%</div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h3 style="color: #4facfe; margin-bottom: 15px;">🏅 ترتيب اللاعبين</h3>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    ${quizPlayers
                        .sort((a, b) => b.score - a.score)
                        .map((player, index) => {
                            const playerSuccessRate = (player.correctAnswers + player.wrongAnswers) > 0 ? 
                                Math.round((player.correctAnswers / (player.correctAnswers + player.wrongAnswers)) * 100) : 0;
                            const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : `${index + 1}.`;
                            
                            return `
                                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <span style="font-size: 20px;">${medal}</span>
                                        <span style="font-weight: bold;">${player.name}</span>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-size: 18px; font-weight: bold; color: #4facfe;">${player.score} نقطة</div>
                                        <div style="font-size: 12px; opacity: 0.8;">
                                            ✅ ${player.correctAnswers} | ❌ ${player.wrongAnswers} | 📊 ${playerSuccessRate}%
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                </div>
            </div>
        `;
        
        showModal('resultsModal');
    }
    
    // دالة لخلط المصفوفة عشوائياً
    function shuffleArray(array) {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
    }
</script>

        <!-- Features Section -->
        <section class="features-section">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-rocket"></i>
                </div>
                <h3 class="feature-title">سرعة فائقة</h3>
                <p class="feature-description">كتابة أكواد تصل إلى 100,000 سطر في ثوانٍ معدودة مع تحسين الأداء</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <h3 class="feature-title">دقة عالية</h3>
                <p class="feature-description">أكواد محسّنة وخالية من الأخطاء مع            </div>
            <div class="feature-card">
                <div class="feature-icon">🔧</div>
                <h3>تعديل ذكي</h3>
                <p>تحليل وتعديل الأكواد الموجودة مع اقتراح التحسينات</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">📁</div>
                <h3>دعم الملفات</h3>
                <p>رفع وتحليل ملفات Lua, HTML, CSS مع حفظ التاريخ</p>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section">
            <h2 style="text-align: center; margin-bottom: 20px;">💎 خطط الاشتراك</h2>
            <p style="text-align: center; opacity: 0.8;">اختر الخطة المناسبة لاحتياجاتك</p>
            
            <div class="pricing-plans">
                <div class="plan-card">
                    <h3>مجاني</h3>
                    <div class="plan-price">$0<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>10 طلبات يومياً</li>
                        <li>دعم أساسي للغات</li>
                        <li>حد أقصى 1000 سطر</li>
                        <li>حفظ لمدة يوم واحد</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="selectPlan('free')">البدء مجاناً</button>
                </div>

                <div class="plan-card popular">
                    <h3>Pro</h3>
                    <div class="plan-price">$29<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>500 طلب يومياً</li>
                        <li>جميع اللغات المدعومة</li>
                        <li>حد أقصى 50,000 سطر</li>
                        <li>حفظ لمدة شهر</li>
                        <li>دعم أولوية</li>
                        <li>تحليل متقدم للأخطاء</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('pro')">اشترك الآن</button>
                </div>

                <div class="plan-card">
                    <h3>Enterprise</h3>
                    <div class="plan-price">$99<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>طلبات غير محدودة</li>
                        <li>جميع المميزات</li>
                        <li>حد أقصى 100,000+ سطر</li>
                        <li>حفظ دائم</li>
                        <li>دعم مخصص 24/7</li>
                        <li>API مخصص</li>
                        <li>تدريب فريق العمل</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('enterprise')">تواصل معنا</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>تسجيل الدخول</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="loginEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="loginPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">دخول</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('loginModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h2>إنشاء حساب جديد</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label>الاسم الكامل</label>
                    <input type="text" id="registerName" placeholder="اسمك الكامل" required>
                </div>
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="registerEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="registerPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">إنشاء حساب</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('registerModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userUsage = 0;
        let dailyLimit = 10;
        let userFiles = [];
        let conversationHistory = [];

        // Sample code templates
        const codeTemplates = {
            lua: {
                basic: `-- Lua Script Example
function greet(name)
    return "Hello, " .. name .. "!"
end

local userName = "User"
print(greet(userName))

-- Table example
local myTable = {
    name = "PixyAi",
    version = "1.0",
    features = {"Fast", "Smart", "Reliable"}
}

for i, feature in ipairs(myTable.features) do
    print(i .. ". " .. feature)
end`,
                
                advanced: `-- Advanced Lua Application
local json = require("json")
local http = require("socket.http")

-- Class definition
local WebAPI = {}
WebAPI.__index = WebAPI

function WebAPI:new(baseUrl)
    local instance = {
        baseUrl = baseUrl,
        headers = {
            ["Content-Type"] = "application/json",
            ["User-Agent"] = "Lua-PixyAi/1.0"
        }
    }
    setmetatable(instance, WebAPI)
    return instance
end

function WebAPI:get(endpoint)
    local url = self.baseUrl .. endpoint
    local response, status = http.request(url)
    
    if status == 200 then
        return json.decode(response)
    else
        error("HTTP Error: " .. status)
    end
end

function WebAPI:post(endpoint, data)
    local url = self.baseUrl .. endpoint
    local jsonData = json.encode(data)
    
    local response, status = http.request{
        url = url,
        method = "POST",
        headers = self.headers,
        source = ltn12.source.string(jsonData)
    }
    
    return json.decode(response)
end

-- Usage example
local api = WebAPI:new("https://api.example.com/")
local userData = api:get("/users/123")
print("User: " .. userData.name)`
            },
            
            html: {
                basic: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع بسيط</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>مرحباً بك في موقعي</h1>
        <p>هذا موقع بسيط تم إنشاؤه بواسطة PixyAi Pro</p>
        <button class="btn" onclick="alert('مرحباً!')">اضغط هنا</button>
    </div>
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->
</body>
</html>`,
                
                advanced: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق ويب متقدم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .app-container {
            display: grid;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            grid-template-rows: 80px 1fr 60px;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }
        
        .header {
            grid-area: header;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .sidebar {
            grid-area: sidebar;
            background: rgba(0,0,0,0.2);
            padding: 30px 20px;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .main-content {
            grid-area: main;
            padding: 30px;
            overflow-y: auto;
        }
        
        .footer {
            grid-area: footer;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .nav-item {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .nav-item.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: bold;
            color: #ff6b6b;
            display: block;
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
                grid-template-columns: 1fr;
                grid-template-rows: 80px 1fr 60px;
            }
            
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>🚀 تطبيق الويب المتقدم</h1>
            <div>
                <button class="btn">الإعدادات</button>
                <button class="btn">تسجيل خروج</button>
            </div>
        </header>
        
        <aside class="sidebar">
            <a href="#" class="nav-item active">الرئيسية</a>
            <a href="#" class="nav-item">التحليلات</a>
            <a href="#" class="nav-item">المستخدمون</a>
            <a href="#" class="nav-item">الإعدادات</a>
        </aside>
        
        <main class="main-content">
            <div class="dashboard-grid">
                <div class="card stat-card">
                    <span class="stat-number">1,234</span>
                    <span>زيارات اليوم</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">567</span>
                    <span>مستخدم نشط</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">89%</span>
                    <span>معدل التفاعل</span>
                </div>
            </div>
            
            <div class="card">
                <h2>آخر النشاطات</h2>
                <p>هنا يمكنك عرض آخر النشاطات والأحداث في التطبيق الخاص بك.</p>
            </div>
        </main>
        
        <footer class="footer">
            <p>© 2023 PixyAi Pro - جميع الحقوق محفوظة</p>
        </footer>
    </div>
</body>
</html>`
            },
            
            css: {
                basic: `/* CSS Basic Example */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
    color: #333;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    padding: 20px;
    text-align: center;
    border-radius: 10px;
    margin-bottom: 30px;
}

.btn {
    display: inline-block;
    padding: 12px 24px;
    background: #ff6b6b;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn:hover {
    background: #ee5a24;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}`,
                
                advanced: `/* Advanced CSS Example */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
    --accent-color: #ff6b6b;
    --text-color: #333;
    --light-bg: #f9f9f9;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
    --shadow-md: 0 5px 15px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--light-bg);
}

.container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.grid {
    display: grid;
    gap: 30px;
}

.grid-2 {
    grid-template-columns: repeat(2, 1fr);
}

.grid-3 {
    grid-template-columns: repeat(3, 1fr);
}

.grid-4 {
    grid-template-columns: repeat(4, 1fr);
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 12px 24px;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
}

.btn-primary {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

@media (max-width: 768px) {
    .grid-2, 
    .grid-3, 
    .grid-4 {
        grid-template-columns: 1fr;
    }
    
    .btn {
        padding: 10px 20px;
    }
}`
            }
        };

        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userStatus = document.getElementById('userStatus');
        const usageProgress = document.getElementById('usageProgress');
        const usageText = document.getElementById('usageText');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const uploadedFiles = document.getElementById('uploadedFiles');

        // Initialize the app
        function init() {
            // Check if user is logged in (from localStorage)
            const savedUser = localStorage.getItem('PixyAiUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserUI();
            }

            // Add event listeners
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            
            // Allow sending message with Enter key
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple validation
            if (!email || !password) {
                alert('الرجاء إدخال البريد الإلكتروني وكلمة المرور');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: 'مستخدم جديد',
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('loginModal');
            
            // Reset form
            loginForm.reset();
        }

               // Handle register
                // Handle register
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            // Simple validation
            if (!name || !email || !password) {
                alert('الرجاء إدخال جميع الحقول المطلوبة');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: name,
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('registerModal');
            
            // Reset form
            registerForm.reset();
        }

        // Logout user
        function logout() {
            currentUser = null;
            userUsage = 0;
            userFiles = [];
            conversationHistory = [];
            
            // Remove from localStorage
            localStorage.removeItem('PixyAiUser');
            
            // Update UI
            updateUserUI();
            
            // Clear chat
            chatMessages.innerHTML = `
                <div class="bot-message">
                    مرحباً! أنا PixyAi Pro 🤖<br>
                    يمكنني مساعدتك في:<br>
                    • كتابة أكواد Lua, HTML, CSS<br>
                    • تعديل وتحسين الأكواد<br>
                    • كتابة أكثر من 100,000 سطر بسرعة<br>
                    • تحليل وإصلاح الأخطاء<br><br>
                    كيف يمكنني مساعدتك اليوم؟
                </div>
            `;
        }

        // Update user UI
        function updateUserUI() {
            if (currentUser) {
                // Show user info and logout button
                userInfo.classList.remove('hidden');
                logoutBtn.classList.remove('hidden');
                
                // Hide login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.add('hidden');
                });
                
                // Set user info
                userName.textContent = `مرحباً ${currentUser.name}!`;
                
                // Set plan info
                userStatus.textContent = currentUser.plan === 'free' ? 'مجاني' : 
                                      currentUser.plan === 'pro' ? 'Pro' : 'Enterprise';
                userStatus.className = 'subscription-status ' + 
                                      (currentUser.plan === 'free' ? 'status-free' : 
                                       currentUser.plan === 'pro' ? 'status-pro' : 'status-enterprise');
                
                // Update usage
                updateUsage();
            } else {
                // Hide user info and logout button
                userInfo.classList.add('hidden');
                logoutBtn.classList.add('hidden');
                
                // Show login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.remove('hidden');
                });
            }
        }

        // Update usage progress
        function updateUsage() {
            if (!currentUser) return;
            
            const maxRequests = currentUser.plan === 'free' ? 10 : 
                              currentUser.plan === 'pro' ? 500 : Infinity;
            
            const percentage = Math.min((userUsage / maxRequests) * 100, 100);
            usageProgress.style.width = `${percentage}%`;
            usageText.textContent = currentUser.plan === 'enterprise' ? 
                                  'طلبات غير محدودة' : 
                                  `${userUsage}/${maxRequests} طلبات`;
        }

        // Handle file upload
        function handleFileUpload(input) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لرفع الملفات');
                return;
            }
            
            const file = input.files[0];
            if (!file) return;
            
            // Check file type
            const validExtensions = ['.lua', '.html', '.css'];
            const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
            
            if (!validExtensions.includes(fileExt)) {
                alert('نوع الملف غير مدعوم. الرجاء رفع ملفات بصيغة .lua أو .html أو .css فقط');
                return;
            }
            
            // Read file content
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                // Add to user files
                userFiles.push({
                    name: file.name,
                    content: content,
                    type: fileExt.substring(1),
                    date: new Date().toLocaleString()
                });
                
                // Display uploaded file
                displayUploadedFiles();
                
                // Add bot message
                addBotMessage(`تم رفع الملف "${file.name}" بنجاح. يمكنك الآن طلب تعديله أو تحليله.`);
            };
            reader.readAsText(file);
        }

        // Display uploaded files
        function displayUploadedFiles() {
            if (userFiles.length === 0) {
                uploadedFiles.innerHTML = '';
                return;
            }
            
            let html = '<h3>📂 الملفات المرفوعة</h3><ul style="list-style: none; margin-top: 10px;">';
            
            userFiles.forEach((file, index) => {
                html += `
                    <li style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${file.name}</span>
                            <small>${file.date}</small>
                        </div>
                        <small style="color: rgba(255,255,255,0.7);">${file.type.toUpperCase()} - ${Math.ceil(file.content.length / 1024)} KB</small>
                        <div style="margin-top: 5px;">
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="analyzeFile(${index})">تحليل</button>
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="editFile(${index})">تعديل</button>
                        </div>
                    </li>
                `;
            });
            
            html += '</ul>';
            uploadedFiles.innerHTML = html;
        }

        // Analyze file
        function analyzeFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            let analysis = '';
            
            // Simple analysis based on file type
            if (file.type === 'lua') {
                analysis = `تحليل ملف Lua:
- عدد الأسطر: ${file.content.split('\n').length}
- عدد الدوال: ${(file.content.match(/function/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/local\s+\w+/g) || []).length}
- يحتوي على: ${file.content.includes('require') ? 'وحدات خارجية' : 'لا يوجد وحدات خارجية'}`;
            } else if (file.type === 'html') {
                analysis = `تحليل ملف HTML:
- عدد العناصر: ${(file.content.match(/<\w+/g) || []).length}
- يحتوي على: ${file.content.includes('<style>') ? 'CSS داخلي' : 'لا يوجد CSS داخلي'}
- يحتوي على: ${file.content.includes('<script>') ? 'JavaScript داخلي' : 'لا يوجد JavaScript داخلي'}`;
            } else if (file.type === 'css') {
                analysis = `تحليل ملف CSS:
- عدد القواعد: ${(file.content.match(/[^{]+\{[^}]+\}/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/--[\w-]+:/g) || []).length}
- يحتوي على: ${file.content.includes('@media') ? 'استعلامات وسائط' : 'لا يوجد استعلامات وسائط'}`;
            }
            
            addBotMessage(analysis);
            incrementUsage();
        }

        // Edit file
        function editFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            addUserMessage(`أريد تعديل ملف ${file.name}`);
            
            // Simulate bot thinking
            setTimeout(() => {
                let editedContent = '';
                
                // Simple edits based on file type
                if (file.type === 'lua') {
                    editedContent = file.content + '\n\n-- تمت إضافة هذا التعليق بواسطة PixyAi Pro';
                } else if (file.type === 'html') {
                    editedContent = file.content.replace(/<\/body>/, '<!-- تمت إضافة هذا التعليق بواسطة PixyAi Pro -->\n</body>');
                } else if (file.type === 'css') {
                    editedContent = file.content + '\n\n/* تمت إضافة هذا التعليق بواسطة PixyAi Pro */';
                }
                
                // Update file content
                userFiles[index].content = editedContent;
                
                // Show edited content
                addBotMessage(`تم تعديل الملف ${file.name}. إليك المحتوى المعدل:`);
                addCodeMessage(editedContent, file.type);
                
                incrementUsage();
            }, 1500);
        }

        // Select plan
        function selectPlan(plan) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لتغيير الخطة');
                return;
            }
            
            currentUser.plan = plan;
            localStorage.setItem('PixyAiUser', JSON.stringify(currentUser));
            updateUserUI();
            
            if (plan === 'enterprise') {
                addBotMessage('شكراً لاهتمامك بخطة Enterprise! سيتصل بك فريق الدعم قريباً.');
            } else {
                addBotMessage(`تم تحديث اشتراكك إلى الخطة ${plan === 'pro' ? 'Pro' : 'المجانية'} بنجاح.`);
            }
        }

        // Send message
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لإرسال الرسائل');
                return;
            }
            
            // Check daily limit
            if (currentUser.plan === 'free' && userUsage >= 10) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة المجانية. قم بالترقية لطلب المزيد.');
                return;
            } else if (currentUser.plan === 'pro' && userUsage >= 500) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة Pro. قم بالترقية إلى Enterprise لطلبات غير محدودة.');
                return;
            }
            
            addUserMessage(message);
            messageInput.value = '';
            
            // Simulate bot thinking
            setTimeout(() => {
                generateBotResponse(message);
                incrementUsage();
            }, 1000);
        }


// Generate bot response
function generateBotResponse(message) {
    let response = '';
    let code = '';
    
    // Convert message to lowercase for easier matching
    const lowerMessage = message.toLowerCase();
    
    // Check if message is not in Arabic
    const isNonArabic = /[a-z]/.test(message);
    
    // Respond in the same language as the user
    if (isNonArabic) {
        response = generateEnglishResponse(message);
        addBotMessage(response);
        return;
    }
    
    // Handle greetings and general questions in Arabic
    if (lowerMessage.includes('السلام عليكم') || lowerMessage.includes('سلام') || 
        lowerMessage.includes('مرحبا') || lowerMessage.includes('اهلا') || 
        lowerMessage.includes('مرحباً') || lowerMessage.includes('أهلا')) {
        const greetings = [
            "وعليكم السلام ورحمة الله وبركاته! كيف يمكنني مساعدتك اليوم؟",
            "مرحباً بك! كيف أساعدك اليوم؟",
            "أهلاً وسهلاً! كيف يمكنني خدمتك؟",
            "وعليكم السلام! كيف حالك اليوم؟"
        ];
        response = greetings[Math.floor(Math.random() * greetings.length)];
        addBotMessage(response);
        return;
    }

        if (lowerMessage.includes('ما هو مؤسس موقع بيكسي')) {
        const greetings = [
            "المؤسس موقع PixyAi هو علي صلاح محمد الواوان الشمري"
                  ];
        response = greetings[Math.floor(Math.random() * greetings.length)];
        addBotMessage(response);
        return;
    }

    
    else if (lowerMessage.includes('كيف حالك') || lowerMessage.includes('اخبارك')) {
        const replies = [
            "بخير والحمد لله، كيف يمكنني مساعدتك؟",
            "أنا بخير، شكراً لسؤالك! كيف أساعدك اليوم؟",
            "الحمد لله دائماً بخير، كيف حالك أنت؟",
            "أنا مجرد برنامج ولكنني أعمل بشكل جيد :) كيف يمكنني مساعدتك؟"
        ];
        response = replies[Math.floor(Math.random() * replies.length)];
        addBotMessage(response);
        return;
    }
    else if (lowerMessage.includes('صباح الخير') || lowerMessage.includes('مساء الخير')) {
        const time = new Date().getHours();
        if (time < 12) {
            response = "صباح الخير! يوم سعيد لك. كيف يمكنني مساعدتك؟";
        } else if (time < 18) {
            response = "مساء الخير! كيف يمكنني مساعدتك اليوم؟";
        } else {
            response = "مساء الخير! أتمنى لك مساءً سعيداً. كيف أساعدك؟";
        }
        addBotMessage(response);
        return;
    }
    
    // باقي الكود كما هو...
    // Check for Lua requests
    if (lowerMessage.includes('لوا') || lowerMessage.includes('lua')) {
        // ... (الكود الحالي للرد على طلبات لوا)
    } 
    // Check for HTML requests
    else if (lowerMessage.includes('html') || lowerMessage.includes('إتش تي إم إل') || lowerMessage.includes('صفحة ويب')) {
        // ... (الكود الحالي للرد على طلبات HTML)
    }
    // Check for CSS requests
    else if (lowerMessage.includes('css') || lowerMessage.includes('سي إس إس') || lowerMessage.includes('تنسيق')) {
        // ... (الكود الحالي للرد على طلبات CSS)
    }
    // General knowledge questions
    else if (lowerMessage.includes('؟') || lowerMessage.includes('ما') || lowerMessage.includes('كيف') || 
             lowerMessage.includes('لماذا') || lowerMessage.includes('أين') || lowerMessage.includes('متى')) {
        response = getGeneralKnowledgeAnswer(message);
        addBotMessage(response);
    }
    // If no specific request
    else {
        response = getGeneralResponse(message);
        addBotMessage(response);
    }
    
    if (code) {
        addCodeMessage(code, lowerMessage.includes('لوا') ? 'lua' : 
                             lowerMessage.includes('html') ? 'html' : 'css');
    }
}


// Update English response function similarly
function generateEnglishResponse(message) {
    const lowerMessage = message.toLowerCase();
    let response = '';
    
    // Handle English greetings
    if (lowerMessage.includes('hi') || lowerMessage.includes('hello') || 
        lowerMessage.includes('hey') || lowerMessage.includes('greetings')) {
        const greetings = [
            "Hello! How can I help you today?",
            "Hi there! What can I do for you?",
            "Greetings! How may I assist you?",
            "Hello! Nice to see you. How can I help?"
        ];
        return greetings[Math.floor(Math.random() * greetings.length)];
    }
    else if (lowerMessage.includes('how are you') || lowerMessage.includes("how's it going")) {
        const replies = [
            "I'm just a program, but I'm functioning well! How can I help you?",
            "I don't have feelings, but I'm ready to assist you!",
            "All systems are operational! How about you?",
            "I'm doing great! What can I do for you today?"
        ];
        return replies[Math.floor(Math.random() * replies.length)];
    }
    else if (lowerMessage.includes('good morning') || lowerMessage.includes('good afternoon') || 
             lowerMessage.includes('good evening')) {
        const time = new Date().getHours();
        if (time < 12) {
            return "Good morning! Have a wonderful day. How can I help?";
        } else if (time < 18) {
            return "Good afternoon! How can I assist you today?";
        } else {
            return "Good evening! I hope you're having a pleasant evening. How may I help?";
        }
    }
    
    // Programming related questions
    if (lowerMessage.includes('lua') || lowerMessage.includes('code') || 
        lowerMessage.includes('html') || lowerMessage.includes('css') || 
        lowerMessage.includes('programming')) {
        return generateProgrammingResponse(message);
    }
    // General questions
    else if (lowerMessage.includes('?') || lowerMessage.includes('what') || 
             lowerMessage.includes('how') || lowerMessage.includes('why') || 
             lowerMessage.includes('when') || lowerMessage.includes('where')) {
        return getEnglishGeneralAnswer(message);
    }
    // Default response
    else {
        return getGeneralResponse(message);
    }
}

// Get general knowledge answer
function getGeneralKnowledgeAnswer(question) {
    const lowerQuestion = question.toLowerCase();
    
    // Sample knowledge base in Arabic
    if (lowerQuestion.includes('الشمس') || lowerQuestion.includes('الشموس')) {
        return "الشمس هي النجم المركزي في نظامنا الشمسي. تدور الأرض حول الشمس مرة كل 365.25 يوم، مما يسبب تغير الفصول.";
    }
    else if (lowerQuestion.includes('القمر') || lowerQuestion.includes('أقمار')) {
        return "القمر هو التابع الطبيعي الوحيد للأرض. يستغرق حوالي 27.3 يوم ليدور حول الأرض، ويسبب ظاهرة المد والجزر.";
    }
    else if (lowerQuestion.includes('البرمجة') || lowerQuestion.includes('مطور')) {
        return "البرمجة هي عملية كتابة تعليمات للحاسوب لتنفيذ مهام محددة. أشهر لغات البرمجة تشمل Python وJavaScript وJava وC++.";
    }
    else if (lowerQuestion.includes('الذكاء الاصطناعي') || lowerQuestion.includes('ai')) {
        return "الذكاء الاصطناعي هو مجال من علوم الحاسوب يهتم بإنشاء أنظمة قادرة على أداء مهام تتطلب ذكاءً بشرياً مثل التعلم واتخاذ القرارات.";
    }
    else {
        const responses = [
            "هذا سؤال مثير للاهتمام! للأسف لدي معلومات محدودة عن هذا الموضوع المحدد. هل يمكنني مساعدتك في شيء آخر؟",
            "أنا متخصص أكثر في مجال البرمجة والتقنية، ولكن حسب معلوماتي... [إجابة عامة]. هل تريد تفاصيل أكثر؟",
            "حاليا لا أملك إجابة دقيقة عن هذا السؤال، لكني يمكنني مساعدتك في مواضيع البرمجة والتقنية.",
            "هذا خارج نطاق تخصصي الأساسي، لكني أحاول التعلم باستمرار. هل لديك أسئلة عن البرمجة أو تطوير الويب؟"
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

// Get English general knowledge answer
function getEnglishGeneralAnswer(question) {
    const lowerQuestion = question.toLowerCase();
    
    // Sample knowledge base in English
    if (lowerQuestion.includes('sun') || lowerQuestion.includes('solar')) {
        return "The Sun is the star at the center of our solar system. Earth orbits around the Sun once every 365.25 days, causing the seasons to change.";
    }
    else if (lowerQuestion.includes('moon') || lowerQuestion.includes('lunar')) {
        return "The Moon is Earth's only natural satellite. It takes about 27.3 days to orbit Earth and causes the tides.";
    }
    else if (lowerQuestion.includes('programming') || lowerQuestion.includes('developer')) {
        return "Programming is the process of writing instructions for computers to perform specific tasks. Popular programming languages include Python, JavaScript, Java, and C++.";
    }
    else if (lowerQuestion.includes('artificial intelligence') || lowerQuestion.includes('ai')) {
        return "Artificial Intelligence is a field of computer science focused on creating systems that can perform tasks requiring human intelligence like learning and decision making.";
    }
    else {
        const responses = [
            "That's an interesting question! Unfortunately I have limited information on this specific topic. Can I help you with something else?",
            "I'm more specialized in programming and tech fields, but from what I know... [general answer]. Would you like more details?",
            "I don't have an exact answer for that right now, but I can help with programming and tech topics.",
            "That's outside my main area of expertise, but I'm constantly learning. Do you have any programming or web development questions?"
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

// Detect language of the message
function detectLanguage(text) {
    // Simple detection based on character ranges
    if (/[\u0600-\u06FF]/.test(text)) {
        return 'arabic';
    } else if (/[a-zA-Z]/.test(text)) {
        return 'english';
    }
    return 'unknown';
}


// Get general response based on language
function getGeneralResponse(message) {
    const lang = detectLanguage(message);
    
    if (lang === 'arabic') {
        const responses = [
            "هل يمكنك توضيح طلبك أكثر؟ كيف يمكنني مساعدتك اليوم؟",
            "أنا هنا لمساعدتك في البرمجة والمعلومات العامة. ما الذي تحتاجه؟",
            "هل تريد مساعدة في موضوع برمجة معين أو لديك سؤال عام؟",
            "كيف يمكنني خدمتك اليوم؟ يمكنني المساعدة في مواضيع التقنية والبرمجة."
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    } else {
        const responses = [
            "Could you clarify your request? How can I help you today?",
            "I'm here to help with programming and general knowledge. What do you need?",
            "Do you need help with a specific programming topic or have a general question?",
            "How can I assist you today? I can help with technology and programming topics."
        ];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

        // Add user message to chat
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'user',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add bot message to chat
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add code message to chat
        function addCodeMessage(code, language) {
            const codeDiv = document.createElement('pre');
            codeDiv.className = 'code-editor';
            codeDiv.textContent = code;
            codeDiv.setAttribute('data-language', language);
            chatMessages.appendChild(codeDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add copy button
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-secondary';
            copyBtn.textContent = 'نسخ الكود';
            copyBtn.style.marginTop = '10px';
            copyBtn.onclick = function() {
                navigator.clipboard.writeText(code);
                copyBtn.textContent = 'تم النسخ!';
                setTimeout(() => {
                    copyBtn.textContent = 'نسخ الكود';
                }, 2000);
            };
            
            const container = document.createElement('div');
            container.className = 'bot-message';
            container.appendChild(copyBtn);
            chatMessages.appendChild(container);
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: '[CODE]',
                code: code,
                language: language,
                time: new Date().toLocaleTimeString()
            });
        }

        // Increment usage counter
        function incrementUsage() {
            if (currentUser && currentUser.plan !== 'enterprise') {
                userUsage++;
                localStorage.setItem('PixyAiUsage', userUsage);
                updateUsage();
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
            
            // Load usage from localStorage
            const savedUsage = localStorage.getItem('PixyAiUsage');
            if (savedUsage) {
                userUsage = parseInt(savedUsage);
                updateUsage();
            }
            
            // Check if usage should reset (new day)
            const lastUsageDate = localStorage.getItem('PixyAiUsageDate');
            const today = new Date().toDateString();
            
            if (lastUsageDate !== today) {
                userUsage = 0;
                localStorage.setItem('PixyAiUsage', '0');
                localStorage.setItem('PixyAiUsageDate', today);
                updateUsage();
            }
        });
    </script>
</body>
</html>
