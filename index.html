<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeBot Pro - بوت كتابة الأكواد الذكي</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #fff;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
        }

        .chat-area {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 18px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .user-message {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            margin-left: auto;
            text-align: right;
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.2);
            margin-right: auto;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
        }

        .chat-input input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .pricing-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .plan-card.popular {
            border-color: #ff6b6b;
            transform: scale(1.05);
        }

        .plan-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .plan-price {
            font-size: 36px;
            font-weight: bold;
            color: #ff6b6b;
            margin: 15px 0;
        }

        .plan-features {
            list-style: none;
            margin: 20px 0;
        }

        .plan-features li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .code-editor {
            background: #1e1e1e;
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .file-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            width: 0%;
            transition: width 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        .hidden {
            display: none;
        }

        .user-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .subscription-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-free {
            background: #95a5a6;
        }

        .status-pro {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .status-enterprise {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">🤖 CodeBot Pro</div>
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="showModal('loginModal')">تسجيل الدخول</button>
                <button class="btn btn-primary" onclick="showModal('registerModal')">إنشاء حساب</button>
                <button class="btn btn-secondary hidden" id="logoutBtn" onclick="logout()">تسجيل خروج</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="user-info hidden" id="userInfo">
                    <h3 id="userName">مرحباً بك!</h3>
                    <div class="subscription-status status-free" id="userStatus">مجاني</div>
                    <div style="margin-top: 15px;">
                        <strong>استخدام اليوم:</strong>
                        <div class="progress-bar">
                            <div class="progress-fill" id="usageProgress"></div>
                        </div>
                        <small id="usageText">0/10 طلبات</small>
                    </div>
                </div>

                <h3>🎯 لغات البرمجة المدعومة</h3>
                <div style="margin: 15px 0;">
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">Lua</span>
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">HTML</span>
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">CSS</span>
                </div>

                <h3>📁 رفع الملفات</h3>
                <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                    <div>📁</div>
                    <p>اضغط لرفع ملف</p>
                    <small>يدعم: .lua, .html, .css</small>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept=".lua,.html,.css" onchange="handleFileUpload(this)">

                <div id="uploadedFiles"></div>

                <h3>⚡ المميزات</h3>
                <ul style="list-style: none; margin-top: 15px;">
                    <li>✅ كتابة أكواد ذكية</li>
                    <li>✅ تعديل الأكواد</li>
                    <li>✅ دعم +100K سطر</li>
                    <li>✅ سرعة فائقة</li>
                    <li>✅ تحليل الأخطاء</li>
                </ul>
            </aside>

            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-messages" id="chatMessages">
                    <div class="bot-message">
                        مرحباً! أنا CodeBot Pro 🤖<br>
                        يمكنني مساعدتك في:<br>
                        • كتابة أكواد Lua, HTML, CSS<br>
                        • تعديل وتحسين الأكواد<br>
                        • كتابة أكثر من 100,000 سطر بسرعة<br>
                        • تحليل وإصلاح الأخطاء<br><br>
                        كيف يمكنني مساعدتك اليوم؟
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="اكتب طلبك هنا... مثل: اكتب لي موقع HTML بسيط">
                    <button class="btn btn-primary" onclick="sendMessage()">إرسال</button>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <section class="features-section">
            <div class="feature-card">
                <div class="feature-icon">🚀</div>
                <h3>سرعة فائقة</h3>
                <p>كتابة أكواد تصل إلى 100,000 سطر في ثوانٍ معدودة مع تحسين الأداء</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🎯</div>
                <h3>دقة عالية</h3>
                <p>أكواد محسّنة وخالية من الأخطاء مع أفضل الممارسات البرمجية</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🔧</div>
                <h3>تعديل ذكي</h3>
                <p>تحليل وتعديل الأكواد الموجودة مع اقتراح التحسينات</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">📁</div>
                <h3>دعم الملفات</h3>
                <p>رفع وتحليل ملفات Lua, HTML, CSS مع حفظ التاريخ</p>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section">
            <h2 style="text-align: center; margin-bottom: 20px;">💎 خطط الاشتراك</h2>
            <p style="text-align: center; opacity: 0.8;">اختر الخطة المناسبة لاحتياجاتك</p>
            
            <div class="pricing-plans">
                <div class="plan-card">
                    <h3>مجاني</h3>
                    <div class="plan-price">$0<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>10 طلبات يومياً</li>
                        <li>دعم أساسي للغات</li>
                        <li>حد أقصى 1000 سطر</li>
                        <li>حفظ لمدة يوم واحد</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="selectPlan('free')">البدء مجاناً</button>
                </div>

                <div class="plan-card popular">
                    <h3>Pro</h3>
                    <div class="plan-price">$29<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>500 طلب يومياً</li>
                        <li>جميع اللغات المدعومة</li>
                        <li>حد أقصى 50,000 سطر</li>
                        <li>حفظ لمدة شهر</li>
                        <li>دعم أولوية</li>
                        <li>تحليل متقدم للأخطاء</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('pro')">اشترك الآن</button>
                </div>

                <div class="plan-card">
                    <h3>Enterprise</h3>
                    <div class="plan-price">$99<small>/شهر</small></div>
                    <ul class="plan-features">
                        <li>طلبات غير محدودة</li>
                        <li>جميع المميزات</li>
                        <li>حد أقصى 100,000+ سطر</li>
                        <li>حفظ دائم</li>
                        <li>دعم مخصص 24/7</li>
                        <li>API مخصص</li>
                        <li>تدريب فريق العمل</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('enterprise')">تواصل معنا</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>تسجيل الدخول</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="loginEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="loginPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">دخول</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('loginModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h2>إنشاء حساب جديد</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label>الاسم الكامل</label>
                    <input type="text" id="registerName" placeholder="اسمك الكامل" required>
                </div>
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="registerEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="registerPassword" placeholder="كلمة المرور" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">إنشاء حساب</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('registerModal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userUsage = 0;
        let dailyLimit = 10;
        let userFiles = [];
        let conversationHistory = [];

        // Sample code templates
        const codeTemplates = {
            lua: {
                basic: `-- Lua Script Example
function greet(name)
    return "Hello, " .. name .. "!"
end

local userName = "User"
print(greet(userName))

-- Table example
local myTable = {
    name = "CodeBot",
    version = "1.0",
    features = {"Fast", "Smart", "Reliable"}
}

for i, feature in ipairs(myTable.features) do
    print(i .. ". " .. feature)
end`,
                
                advanced: `-- Advanced Lua Application
local json = require("json")
local http = require("socket.http")

-- Class definition
local WebAPI = {}
WebAPI.__index = WebAPI

function WebAPI:new(baseUrl)
    local instance = {
        baseUrl = baseUrl,
        headers = {
            ["Content-Type"] = "application/json",
            ["User-Agent"] = "Lua-CodeBot/1.0"
        }
    }
    setmetatable(instance, WebAPI)
    return instance
end

function WebAPI:get(endpoint)
    local url = self.baseUrl .. endpoint
    local response, status = http.request(url)
    
    if status == 200 then
        return json.decode(response)
    else
        error("HTTP Error: " .. status)
    end
end

function WebAPI:post(endpoint, data)
    local url = self.baseUrl .. endpoint
    local jsonData = json.encode(data)
    
    local response, status = http.request{
        url = url,
        method = "POST",
        headers = self.headers,
        source = ltn12.source.string(jsonData)
    }
    
    return json.decode(response)
end

-- Usage example
local api = WebAPI:new("https://api.example.com/")
local userData = api:get("/users/123")
print("User: " .. userData.name)`
            },
            
            html: {
                basic: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع بسيط</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>مرحباً بك في موقعي</h1>
        <p>هذا موقع بسيط تم إنشاؤه بواسطة CodeBot Pro</p>
        <button class="btn" onclick="alert('مرحباً!')">اضغط هنا</button>
    </div>
<!-- تمت إضافة هذا التعليق بواسطة CodeBot Pro -->
<!-- تمت إضافة هذا التعليق بواسطة CodeBot Pro -->
</body>
</html>`,
                
                advanced: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق ويب متقدم</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .app-container {
            display: grid;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            grid-template-rows: 80px 1fr 60px;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }
        
        .header {
            grid-area: header;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .sidebar {
            grid-area: sidebar;
            background: rgba(0,0,0,0.2);
            padding: 30px 20px;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .main-content {
            grid-area: main;
            padding: 30px;
            overflow-y: auto;
        }
        
        .footer {
            grid-area: footer;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .nav-item {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .nav-item.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: bold;
            color: #ff6b6b;
            display: block;
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
                grid-template-columns: 1fr;
                grid-template-rows: 80px 1fr 60px;
            }
            
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>🚀 تطبيق الويب المتقدم</h1>
            <div>
                <button class="btn">الإعدادات</button>
                <button class="btn">تسجيل خروج</button>
            </div>
        </header>
        
        <aside class="sidebar">
            <a href="#" class="nav-item active">الرئيسية</a>
            <a href="#" class="nav-item">التحليلات</a>
            <a href="#" class="nav-item">المستخدمون</a>
            <a href="#" class="nav-item">الإعدادات</a>
        </aside>
        
        <main class="main-content">
            <div class="dashboard-grid">
                <div class="card stat-card">
                    <span class="stat-number">1,234</span>
                    <span>زيارات اليوم</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">567</span>
                    <span>مستخدم نشط</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">89%</span>
                    <span>معدل التفاعل</span>
                </div>
            </div>
            
            <div class="card">
                <h2>آخر النشاطات</h2>
                <p>هنا يمكنك عرض آخر النشاطات والأحداث في التطبيق الخاص بك.</p>
            </div>
        </main>
        
        <footer class="footer">
            <p>© 2023 CodeBot Pro - جميع الحقوق محفوظة</p>
        </footer>
    </div>
</body>
</html>`
            },
            
            css: {
                basic: `/* CSS Basic Example */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
    color: #333;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    padding: 20px;
    text-align: center;
    border-radius: 10px;
    margin-bottom: 30px;
}

.btn {
    display: inline-block;
    padding: 12px 24px;
    background: #ff6b6b;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn:hover {
    background: #ee5a24;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}`,
                
                advanced: `/* Advanced CSS Example */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
    --accent-color: #ff6b6b;
    --text-color: #333;
    --light-bg: #f9f9f9;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
    --shadow-md: 0 5px 15px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--light-bg);
}

.container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.grid {
    display: grid;
    gap: 30px;
}

.grid-2 {
    grid-template-columns: repeat(2, 1fr);
}

.grid-3 {
    grid-template-columns: repeat(3, 1fr);
}

.grid-4 {
    grid-template-columns: repeat(4, 1fr);
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 12px 24px;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
}

.btn-primary {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

@media (max-width: 768px) {
    .grid-2, 
    .grid-3, 
    .grid-4 {
        grid-template-columns: 1fr;
    }
    
    .btn {
        padding: 10px 20px;
    }
}`
            }
        };

        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userStatus = document.getElementById('userStatus');
        const usageProgress = document.getElementById('usageProgress');
        const usageText = document.getElementById('usageText');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const uploadedFiles = document.getElementById('uploadedFiles');

        // Initialize the app
        function init() {
            // Check if user is logged in (from localStorage)
            const savedUser = localStorage.getItem('codeBotUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserUI();
            }

            // Add event listeners
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            
            // Allow sending message with Enter key
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple validation
            if (!email || !password) {
                alert('الرجاء إدخال البريد الإلكتروني وكلمة المرور');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: 'مستخدم جديد',
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('loginModal');
            
            // Reset form
            loginForm.reset();
        }

               // Handle register
                // Handle register
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            // Simple validation
            if (!name || !email || !password) {
                alert('الرجاء إدخال جميع الحقول المطلوبة');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: name,
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('registerModal');
            
            // Reset form
            registerForm.reset();
        }

        // Logout user
        function logout() {
            currentUser = null;
            userUsage = 0;
            userFiles = [];
            conversationHistory = [];
            
            // Remove from localStorage
            localStorage.removeItem('codeBotUser');
            
            // Update UI
            updateUserUI();
            
            // Clear chat
            chatMessages.innerHTML = `
                <div class="bot-message">
                    مرحباً! أنا CodeBot Pro 🤖<br>
                    يمكنني مساعدتك في:<br>
                    • كتابة أكواد Lua, HTML, CSS<br>
                    • تعديل وتحسين الأكواد<br>
                    • كتابة أكثر من 100,000 سطر بسرعة<br>
                    • تحليل وإصلاح الأخطاء<br><br>
                    كيف يمكنني مساعدتك اليوم؟
                </div>
            `;
        }

        // Update user UI
        function updateUserUI() {
            if (currentUser) {
                // Show user info and logout button
                userInfo.classList.remove('hidden');
                logoutBtn.classList.remove('hidden');
                
                // Hide login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.add('hidden');
                });
                
                // Set user info
                userName.textContent = `مرحباً ${currentUser.name}!`;
                
                // Set plan info
                userStatus.textContent = currentUser.plan === 'free' ? 'مجاني' : 
                                      currentUser.plan === 'pro' ? 'Pro' : 'Enterprise';
                userStatus.className = 'subscription-status ' + 
                                      (currentUser.plan === 'free' ? 'status-free' : 
                                       currentUser.plan === 'pro' ? 'status-pro' : 'status-enterprise');
                
                // Update usage
                updateUsage();
            } else {
                // Hide user info and logout button
                userInfo.classList.add('hidden');
                logoutBtn.classList.add('hidden');
                
                // Show login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.remove('hidden');
                });
            }
        }

        // Update usage progress
        function updateUsage() {
            if (!currentUser) return;
            
            const maxRequests = currentUser.plan === 'free' ? 10 : 
                              currentUser.plan === 'pro' ? 500 : Infinity;
            
            const percentage = Math.min((userUsage / maxRequests) * 100, 100);
            usageProgress.style.width = `${percentage}%`;
            usageText.textContent = currentUser.plan === 'enterprise' ? 
                                  'طلبات غير محدودة' : 
                                  `${userUsage}/${maxRequests} طلبات`;
        }

        // Handle file upload
        function handleFileUpload(input) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لرفع الملفات');
                return;
            }
            
            const file = input.files[0];
            if (!file) return;
            
            // Check file type
            const validExtensions = ['.lua', '.html', '.css'];
            const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
            
            if (!validExtensions.includes(fileExt)) {
                alert('نوع الملف غير مدعوم. الرجاء رفع ملفات بصيغة .lua أو .html أو .css فقط');
                return;
            }
            
            // Read file content
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                // Add to user files
                userFiles.push({
                    name: file.name,
                    content: content,
                    type: fileExt.substring(1),
                    date: new Date().toLocaleString()
                });
                
                // Display uploaded file
                displayUploadedFiles();
                
                // Add bot message
                addBotMessage(`تم رفع الملف "${file.name}" بنجاح. يمكنك الآن طلب تعديله أو تحليله.`);
            };
            reader.readAsText(file);
        }

        // Display uploaded files
        function displayUploadedFiles() {
            if (userFiles.length === 0) {
                uploadedFiles.innerHTML = '';
                return;
            }
            
            let html = '<h3>📂 الملفات المرفوعة</h3><ul style="list-style: none; margin-top: 10px;">';
            
            userFiles.forEach((file, index) => {
                html += `
                    <li style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${file.name}</span>
                            <small>${file.date}</small>
                        </div>
                        <small style="color: rgba(255,255,255,0.7);">${file.type.toUpperCase()} - ${Math.ceil(file.content.length / 1024)} KB</small>
                        <div style="margin-top: 5px;">
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="analyzeFile(${index})">تحليل</button>
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="editFile(${index})">تعديل</button>
                        </div>
                    </li>
                `;
            });
            
            html += '</ul>';
            uploadedFiles.innerHTML = html;
        }

        // Analyze file
        function analyzeFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            let analysis = '';
            
            // Simple analysis based on file type
            if (file.type === 'lua') {
                analysis = `تحليل ملف Lua:
- عدد الأسطر: ${file.content.split('\n').length}
- عدد الدوال: ${(file.content.match(/function/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/local\s+\w+/g) || []).length}
- يحتوي على: ${file.content.includes('require') ? 'وحدات خارجية' : 'لا يوجد وحدات خارجية'}`;
            } else if (file.type === 'html') {
                analysis = `تحليل ملف HTML:
- عدد العناصر: ${(file.content.match(/<\w+/g) || []).length}
- يحتوي على: ${file.content.includes('<style>') ? 'CSS داخلي' : 'لا يوجد CSS داخلي'}
- يحتوي على: ${file.content.includes('<script>') ? 'JavaScript داخلي' : 'لا يوجد JavaScript داخلي'}`;
            } else if (file.type === 'css') {
                analysis = `تحليل ملف CSS:
- عدد القواعد: ${(file.content.match(/[^{]+\{[^}]+\}/g) || []).length}
- عدد المتغيرات: ${(file.content.match(/--[\w-]+:/g) || []).length}
- يحتوي على: ${file.content.includes('@media') ? 'استعلامات وسائط' : 'لا يوجد استعلامات وسائط'}`;
            }
            
            addBotMessage(analysis);
            incrementUsage();
        }

        // Edit file
        function editFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            addUserMessage(`أريد تعديل ملف ${file.name}`);
            
            // Simulate bot thinking
            setTimeout(() => {
                let editedContent = '';
                
                // Simple edits based on file type
                if (file.type === 'lua') {
                    editedContent = file.content + '\n\n-- تمت إضافة هذا التعليق بواسطة CodeBot Pro';
                } else if (file.type === 'html') {
                    editedContent = file.content.replace(/<\/body>/, '<!-- تمت إضافة هذا التعليق بواسطة CodeBot Pro -->\n</body>');
                } else if (file.type === 'css') {
                    editedContent = file.content + '\n\n/* تمت إضافة هذا التعليق بواسطة CodeBot Pro */';
                }
                
                // Update file content
                userFiles[index].content = editedContent;
                
                // Show edited content
                addBotMessage(`تم تعديل الملف ${file.name}. إليك المحتوى المعدل:`);
                addCodeMessage(editedContent, file.type);
                
                incrementUsage();
            }, 1500);
        }

        // Select plan
        function selectPlan(plan) {
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لتغيير الخطة');
                return;
            }
            
            currentUser.plan = plan;
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            updateUserUI();
            
            if (plan === 'enterprise') {
                addBotMessage('شكراً لاهتمامك بخطة Enterprise! سيتصل بك فريق الدعم قريباً.');
            } else {
                addBotMessage(`تم تحديث اشتراكك إلى الخطة ${plan === 'pro' ? 'Pro' : 'المجانية'} بنجاح.`);
            }
        }

        // Send message
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            if (!currentUser) {
                alert('يجب تسجيل الدخول أولاً لإرسال الرسائل');
                return;
            }
            
            // Check daily limit
            if (currentUser.plan === 'free' && userUsage >= 10) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة المجانية. قم بالترقية لطلب المزيد.');
                return;
            } else if (currentUser.plan === 'pro' && userUsage >= 500) {
                alert('لقد وصلت إلى الحد اليومي للطلبات في الخطة Pro. قم بالترقية إلى Enterprise لطلبات غير محدودة.');
                return;
            }
            
            addUserMessage(message);
            messageInput.value = '';
            
            // Simulate bot thinking
            setTimeout(() => {
                generateBotResponse(message);
                incrementUsage();
            }, 1000);
        }

// Generate bot response
function generateBotResponse(message) {
    let response = '';
    let code = '';
    
    // Convert message to lowercase for easier matching
    const lowerMessage = message.toLowerCase();
    
    // Check for Lua requests
    if (lowerMessage.includes('لوا') || lowerMessage.includes('lua')) {
        if (lowerMessage.includes('بسيط') || lowerMessage.includes('مثال') || lowerMessage.includes('بداية')) {
            code = codeTemplates.lua.basic;
            response = 'إليك مثالاً أساسياً على كود Lua لمساعدتك في البدء:';
        } else if (lowerMessage.includes('متقدم') || lowerMessage.includes('معقد') || lowerMessage.includes('احترافي')) {
            code = codeTemplates.lua.advanced;
            response = 'ها هو مثال متقدم على كود Lua يمكنك استخدامه كمرجع:';
        } else if (lowerMessage.includes('وظيفة') || lowerMessage.includes('دالة') || lowerMessage.includes('function')) {
            code = `-- مثال على دالة في Lua
function calculateSum(a, b)
    return a + b
end

-- استخدام الدالة
local result = calculateSum(5, 3)
print("ناتج الجمع هو: " .. result)`;
            response = 'إليك مثالاً على كيفية إنشاء واستخدام الدوال في Lua:';
        } else {
            code = codeTemplates.lua.basic;
            response = 'إليك مثالاً على كود Lua يمكنك البناء عليه:';
        }
    } 
    // Check for HTML requests
    else if (lowerMessage.includes('html') || lowerMessage.includes('إتش تي إم إل') || lowerMessage.includes('صفحة ويب')) {
        if (lowerMessage.includes('بسيط') || lowerMessage.includes('مثال') || lowerMessage.includes('بداية')) {
            code = codeTemplates.html.basic;
            response = 'إليك نموذجاً أساسياً لصفحة HTML يمكنك استخدامه:';
        } else if (lowerMessage.includes('متقدم') || lowerMessage.includes('معقد') || lowerMessage.includes('احترافي')) {
            code = codeTemplates.html.advanced;
            response = 'ها هو نموذج متقدم لصفحة HTML بتصميم حديث:';
        } else if (lowerMessage.includes('جدول') || lowerMessage.includes('table')) {
            code = `<!DOCTYPE html>
<html>
<head>
    <title>جدول HTML</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <table>
        <tr>
            <th>الاسم</th>
            <th>العمر</th>
        </tr>
        <tr>
            <td>أحمد</td>
            <td>25</td>
        </tr>
        <tr>
            <td>محمد</td>
            <td>30</td>
        </tr>
    </table>
</body>
</html>`;
            response = 'إليك مثالاً على كيفية إنشاء جدول في HTML:';
        } else {
            code = codeTemplates.html.basic;
            response = 'إليك نموذجاً لصفحة HTML لمساعدتك:';
        }
    }
    // Check for CSS requests
    else if (lowerMessage.includes('css') || lowerMessage.includes('سي إس إس') || lowerMessage.includes('تنسيق')) {
        if (lowerMessage.includes('بسيط') || lowerMessage.includes('مثال') || lowerMessage.includes('بداية')) {
            code = codeTemplates.css.basic;
            response = 'إليك مثالاً أساسياً على كود CSS للتنسيقات العامة:';
        } else if (lowerMessage.includes('متقدم') || lowerMessage.includes('معقد') || lowerMessage.includes('احترافي')) {
            code = codeTemplates.css.advanced;
            response = 'ها هو مثال متقدم على كود CSS باستخدام متغيرات وتنسيقات حديثة:';
        } else if (lowerMessage.includes('متجاوب') || lowerMessage.includes('responsive')) {
            code = `/* مثال على CSS للتصميم المتجاوب */
.container {
    width: 100%;
    padding: 20px;
}

@media (min-width: 768px) {
    .container {
        width: 750px;
        margin: 0 auto;
    }
}

@media (min-width: 992px) {
    .container {
        width: 970px;
    }
}

@media (min-width: 1200px) {
    .container {
        width: 1170px;
    }
}`;
            response = 'إليك مثالاً على كيفية جعل التصميم متجاوباً مع مختلف أحجام الشاشات:';
        } else {
            code = codeTemplates.css.basic;
            response = 'إليك مثالاً على كود CSS يمكنك استخدامه:';
        }
    }
    // General programming questions
    else if (lowerMessage.includes('برمجة') || lowerMessage.includes('كود') || lowerMessage.includes('برنامج')) {
        response = 'أنا متخصص في مساعدتك بأكواد Lua و HTML و CSS. هل يمكنك تحديد أي من هذه اللغات تحتاج مساعدة فيها؟';
    }
    // If no specific request
    else {
        const randomResponses = [
            'هل يمكنك توضيح طلبك أكثر؟ هل تريد مساعدة في Lua أو HTML أو CSS؟',
            'أنا هنا لمساعدتك في كتابة وتعديل الأكواد. ما هي اللغة التي تريد العمل عليها؟',
            'لأساعدك بشكل أفضل، أخبرني ما إذا كنت تريد العمل على Lua أو HTML أو CSS.',
            'أحتاج إلى مزيد من التفاصيل. هل تريد مساعدة في لغة برمجة معينة مثل Lua أو HTML أو CSS؟'
        ];
        response = randomResponses[Math.floor(Math.random() * randomResponses.length)];
    }
    
    if (response) {
        addBotMessage(response);
    }
    
    if (code) {
        addCodeMessage(code, lowerMessage.includes('لوا') ? 'lua' : 
                             lowerMessage.includes('html') ? 'html' : 'css');
    }
}

        // Add user message to chat
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'user',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add bot message to chat
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add code message to chat
        function addCodeMessage(code, language) {
            const codeDiv = document.createElement('pre');
            codeDiv.className = 'code-editor';
            codeDiv.textContent = code;
            codeDiv.setAttribute('data-language', language);
            chatMessages.appendChild(codeDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add copy button
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-secondary';
            copyBtn.textContent = 'نسخ الكود';
            copyBtn.style.marginTop = '10px';
            copyBtn.onclick = function() {
                navigator.clipboard.writeText(code);
                copyBtn.textContent = 'تم النسخ!';
                setTimeout(() => {
                    copyBtn.textContent = 'نسخ الكود';
                }, 2000);
            };
            
            const container = document.createElement('div');
            container.className = 'bot-message';
            container.appendChild(copyBtn);
            chatMessages.appendChild(container);
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: '[CODE]',
                code: code,
                language: language,
                time: new Date().toLocaleTimeString()
            });
        }

        // Increment usage counter
        function incrementUsage() {
            if (currentUser && currentUser.plan !== 'enterprise') {
                userUsage++;
                localStorage.setItem('codeBotUsage', userUsage);
                updateUsage();
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
            
            // Load usage from localStorage
            const savedUsage = localStorage.getItem('codeBotUsage');
            if (savedUsage) {
                userUsage = parseInt(savedUsage);
                updateUsage();
            }
            
            // Check if usage should reset (new day)
            const lastUsageDate = localStorage.getItem('codeBotUsageDate');
            const today = new Date().toDateString();
            
            if (lastUsageDate !== today) {
                userUsage = 0;
                localStorage.setItem('codeBotUsage', '0');
                localStorage.setItem('codeBotUsageDate', today);
                updateUsage();
            }
        });
    </script>
</body>
</html>