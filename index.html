<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeBot Pro - Ø¨ÙˆØª ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø°ÙƒÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #fff;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            height: fit-content;
        }

        .chat-area {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 18px;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .user-message {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            margin-left: auto;
            text-align: right;
        }

        .bot-message {
            background: rgba(255, 255, 255, 0.2);
            margin-right: auto;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
        }

        .chat-input input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .pricing-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .plan-card.popular {
            border-color: #ff6b6b;
            transform: scale(1.05);
        }

        .plan-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .plan-price {
            font-size: 36px;
            font-weight: bold;
            color: #ff6b6b;
            margin: 15px 0;
        }

        .plan-features {
            list-style: none;
            margin: 20px 0;
        }

        .plan-features li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .code-editor {
            background: #1e1e1e;
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .file-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            width: 0%;
            transition: width 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        .hidden {
            display: none;
        }

        .user-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .subscription-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-free {
            background: #95a5a6;
        }

        .status-pro {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .status-enterprise {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">ğŸ¤– CodeBot Pro</div>
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="showModal('loginModal')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <button class="btn btn-primary" onclick="showModal('registerModal')">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                <button class="btn btn-secondary hidden" id="logoutBtn" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="user-info hidden" id="userInfo">
                    <h3 id="userName">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ!</h3>
                    <div class="subscription-status status-free" id="userStatus">Ù…Ø¬Ø§Ù†ÙŠ</div>
                    <div style="margin-top: 15px;">
                        <strong>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…:</strong>
                        <div class="progress-bar">
                            <div class="progress-fill" id="usageProgress"></div>
                        </div>
                        <small id="usageText">0/10 Ø·Ù„Ø¨Ø§Øª</small>
                    </div>
                </div>

                <h3>ğŸ¯ Ù„ØºØ§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©</h3>
                <div style="margin: 15px 0;">
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">Lua</span>
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">HTML</span>
                    <span class="btn btn-secondary" style="margin: 5px; font-size: 12px;">CSS</span>
                </div>

                <h3>ğŸ“ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
                <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                    <div>ğŸ“</div>
                    <p>Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ Ù…Ù„Ù</p>
                    <small>ÙŠØ¯Ø¹Ù…: .lua, .html, .css</small>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept=".lua,.html,.css" onchange="handleFileUpload(this)">

                <div id="uploadedFiles"></div>

                <h3>âš¡ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</h3>
                <ul style="list-style: none; margin-top: 15px;">
                    <li>âœ… ÙƒØªØ§Ø¨Ø© Ø£ÙƒÙˆØ§Ø¯ Ø°ÙƒÙŠØ©</li>
                    <li>âœ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</li>
                    <li>âœ… Ø¯Ø¹Ù… +100K Ø³Ø·Ø±</li>
                    <li>âœ… Ø³Ø±Ø¹Ø© ÙØ§Ø¦Ù‚Ø©</li>
                    <li>âœ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</li>
                </ul>
            </aside>

            <!-- Chat Area -->
            <div class="chat-area">
                <div class="chat-messages" id="chatMessages">
                    <div class="bot-message">
                        Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ CodeBot Pro ğŸ¤–<br>
                        ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:<br>
                        â€¢ ÙƒØªØ§Ø¨Ø© Ø£ÙƒÙˆØ§Ø¯ Lua, HTML, CSS<br>
                        â€¢ ØªØ¹Ø¯ÙŠÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯<br>
                        â€¢ ÙƒØªØ§Ø¨Ø© Ø£ÙƒØ«Ø± Ù…Ù† 100,000 Ø³Ø·Ø± Ø¨Ø³Ø±Ø¹Ø©<br>
                        â€¢ ØªØ­Ù„ÙŠÙ„ ÙˆØ¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡<br><br>
                        ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø·Ù„Ø¨Ùƒ Ù‡Ù†Ø§... Ù…Ø«Ù„: Ø§ÙƒØªØ¨ Ù„ÙŠ Ù…ÙˆÙ‚Ø¹ HTML Ø¨Ø³ÙŠØ·">
                    <button class="btn btn-primary" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <section class="features-section">
            <div class="feature-card">
                <div class="feature-icon">ğŸš€</div>
                <h3>Ø³Ø±Ø¹Ø© ÙØ§Ø¦Ù‚Ø©</h3>
                <p>ÙƒØªØ§Ø¨Ø© Ø£ÙƒÙˆØ§Ø¯ ØªØµÙ„ Ø¥Ù„Ù‰ 100,000 Ø³Ø·Ø± ÙÙŠ Ø«ÙˆØ§Ù†Ù Ù…Ø¹Ø¯ÙˆØ¯Ø© Ù…Ø¹ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ¯</div>
                <h3>Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©</h3>
                <p>Ø£ÙƒÙˆØ§Ø¯ Ù…Ø­Ø³Ù‘Ù†Ø© ÙˆØ®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ”§</div>
                <h3>ØªØ¹Ø¯ÙŠÙ„ Ø°ÙƒÙŠ</h3>
                <p>ØªØ­Ù„ÙŠÙ„ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø¹ Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ“</div>
                <h3>Ø¯Ø¹Ù… Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
                <p>Ø±ÙØ¹ ÙˆØªØ­Ù„ÙŠÙ„ Ù…Ù„ÙØ§Øª Lua, HTML, CSS Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„ØªØ§Ø±ÙŠØ®</p>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section">
            <h2 style="text-align: center; margin-bottom: 20px;">ğŸ’ Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h2>
            <p style="text-align: center; opacity: 0.8;">Ø§Ø®ØªØ± Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ</p>
            
            <div class="pricing-plans">
                <div class="plan-card">
                    <h3>Ù…Ø¬Ø§Ù†ÙŠ</h3>
                    <div class="plan-price">$0<small>/Ø´Ù‡Ø±</small></div>
                    <ul class="plan-features">
                        <li>10 Ø·Ù„Ø¨Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹</li>
                        <li>Ø¯Ø¹Ù… Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„ØºØ§Øª</li>
                        <li>Ø­Ø¯ Ø£Ù‚ØµÙ‰ 1000 Ø³Ø·Ø±</li>
                        <li>Ø­ÙØ¸ Ù„Ù…Ø¯Ø© ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="selectPlan('free')">Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ø¬Ø§Ù†Ø§Ù‹</button>
                </div>

                <div class="plan-card popular">
                    <h3>Pro</h3>
                    <div class="plan-price">$29<small>/Ø´Ù‡Ø±</small></div>
                    <ul class="plan-features">
                        <li>500 Ø·Ù„Ø¨ ÙŠÙˆÙ…ÙŠØ§Ù‹</li>
                        <li>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©</li>
                        <li>Ø­Ø¯ Ø£Ù‚ØµÙ‰ 50,000 Ø³Ø·Ø±</li>
                        <li>Ø­ÙØ¸ Ù„Ù…Ø¯Ø© Ø´Ù‡Ø±</li>
                        <li>Ø¯Ø¹Ù… Ø£ÙˆÙ„ÙˆÙŠØ©</li>
                        <li>ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ø£Ø®Ø·Ø§Ø¡</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('pro')">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
                </div>

                <div class="plan-card">
                    <h3>Enterprise</h3>
                    <div class="plan-price">$99<small>/Ø´Ù‡Ø±</small></div>
                    <ul class="plan-features">
                        <li>Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©</li>
                        <li>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</li>
                        <li>Ø­Ø¯ Ø£Ù‚ØµÙ‰ 100,000+ Ø³Ø·Ø±</li>
                        <li>Ø­ÙØ¸ Ø¯Ø§Ø¦Ù…</li>
                        <li>Ø¯Ø¹Ù… Ù…Ø®ØµØµ 24/7</li>
                        <li>API Ù…Ø®ØµØµ</li>
                        <li>ØªØ¯Ø±ÙŠØ¨ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„</li>
                    </ul>
                    <button class="btn btn-primary" onclick="selectPlan('enterprise')">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="loginEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">Ø¯Ø®ÙˆÙ„</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('loginModal')">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <input type="text" id="registerName" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" required>
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="registerEmail" placeholder="example@email.com" required>
                </div>
                <div class="form-group">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="registerPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('registerModal')">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let userUsage = 0;
        let dailyLimit = 10;
        let userFiles = [];
        let conversationHistory = [];

        // Sample code templates
        const codeTemplates = {
            lua: {
                basic: `-- Lua Script Example
function greet(name)
    return "Hello, " .. name .. "!"
end

local userName = "User"
print(greet(userName))

-- Table example
local myTable = {
    name = "CodeBot",
    version = "1.0",
    features = {"Fast", "Smart", "Reliable"}
}

for i, feature in ipairs(myTable.features) do
    print(i .. ". " .. feature)
end`,
                
                advanced: `-- Advanced Lua Application
local json = require("json")
local http = require("socket.http")

-- Class definition
local WebAPI = {}
WebAPI.__index = WebAPI

function WebAPI:new(baseUrl)
    local instance = {
        baseUrl = baseUrl,
        headers = {
            ["Content-Type"] = "application/json",
            ["User-Agent"] = "Lua-CodeBot/1.0"
        }
    }
    setmetatable(instance, WebAPI)
    return instance
end

function WebAPI:get(endpoint)
    local url = self.baseUrl .. endpoint
    local response, status = http.request(url)
    
    if status == 200 then
        return json.decode(response)
    else
        error("HTTP Error: " .. status)
    end
end

function WebAPI:post(endpoint, data)
    local url = self.baseUrl .. endpoint
    local jsonData = json.encode(data)
    
    local response, status = http.request{
        url = url,
        method = "POST",
        headers = self.headers,
        source = ltn12.source.string(jsonData)
    }
    
    return json.decode(response)
end

-- Usage example
local api = WebAPI:new("https://api.example.com/")
local userData = api:get("/users/123")
print("User: " .. userData.name)`
            },
            
            html: {
                basic: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙˆÙ‚Ø¹ Ø¨Ø³ÙŠØ·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
        }
        .btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ÙˆÙ‚Ø¹ÙŠ</h1>
        <p>Ù‡Ø°Ø§ Ù…ÙˆÙ‚Ø¹ Ø¨Ø³ÙŠØ· ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro</p>
        <button class="btn" onclick="alert('Ù…Ø±Ø­Ø¨Ø§Ù‹!')">Ø§Ø¶ØºØ· Ù‡Ù†Ø§</button>
    </div>
<!-- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro -->
<!-- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro -->
</body>
</html>`,
                
                advanced: `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ù…ØªÙ‚Ø¯Ù…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        .app-container {
            display: grid;
            grid-template-areas: 
                "header header"
                "sidebar main"
                "footer footer";
            grid-template-rows: 80px 1fr 60px;
            grid-template-columns: 250px 1fr;
            min-height: 100vh;
        }
        
        .header {
            grid-area: header;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .sidebar {
            grid-area: sidebar;
            background: rgba(0,0,0,0.2);
            padding: 30px 20px;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .main-content {
            grid-area: main;
            padding: 30px;
            overflow-y: auto;
        }
        
        .footer {
            grid-area: footer;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .nav-item {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .nav-item.active {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: bold;
            color: #ff6b6b;
            display: block;
        }
        
        @media (max-width: 768px) {
            .app-container {
                grid-template-areas: 
                    "header"
                    "main"
                    "footer";
                grid-template-columns: 1fr;
                grid-template-rows: 80px 1fr 60px;
            }
            
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>ğŸš€ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆÙŠØ¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
            <div>
                <button class="btn">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                <button class="btn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>
        </header>
        
        <aside class="sidebar">
            <a href="#" class="nav-item active">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="#" class="nav-item">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</a>
            <a href="#" class="nav-item">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</a>
            <a href="#" class="nav-item">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
        </aside>
        
        <main class="main-content">
            <div class="dashboard-grid">
                <div class="card stat-card">
                    <span class="stat-number">1,234</span>
                    <span>Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙŠÙˆÙ…</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">567</span>
                    <span>Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø·</span>
                </div>
                <div class="card stat-card">
                    <span class="stat-number">89%</span>
                    <span>Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙØ§Ø¹Ù„</span>
                </div>
            </div>
            
            <div class="card">
                <h2>Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h2>
                <p>Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª ÙˆØ§Ù„Ø£Ø­Ø¯Ø§Ø« ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.</p>
            </div>
        </main>
        
        <footer class="footer">
            <p>Â© 2023 CodeBot Pro - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
        </footer>
    </div>
</body>
</html>`
            },
            
            css: {
                basic: `/* CSS Basic Example */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f5f5f5;
    color: #333;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    background: linear-gradient(45deg, #667eea, #764ba2);
    color: white;
    padding: 20px;
    text-align: center;
    border-radius: 10px;
    margin-bottom: 30px;
}

.btn {
    display: inline-block;
    padding: 12px 24px;
    background: #ff6b6b;
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn:hover {
    background: #ee5a24;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}`,
                
                advanced: `/* Advanced CSS Example */
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
    --accent-color: #ff6b6b;
    --text-color: #333;
    --light-bg: #f9f9f9;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
    --shadow-md: 0 5px 15px rgba(0,0,0,0.1);
    --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--light-bg);
}

.container {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.grid {
    display: grid;
    gap: 30px;
}

.grid-2 {
    grid-template-columns: repeat(2, 1fr);
}

.grid-3 {
    grid-template-columns: repeat(3, 1fr);
}

.grid-4 {
    grid-template-columns: repeat(4, 1fr);
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 12px 24px;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-sm);
}

.btn-primary {
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: var(--shadow-sm);
    transition: var(--transition);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

@media (max-width: 768px) {
    .grid-2, 
    .grid-3, 
    .grid-4 {
        grid-template-columns: 1fr;
    }
    
    .btn {
        padding: 10px 20px;
    }
}`
            }
        };

        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userStatus = document.getElementById('userStatus');
        const usageProgress = document.getElementById('usageProgress');
        const usageText = document.getElementById('usageText');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const uploadedFiles = document.getElementById('uploadedFiles');

        // Initialize the app
        function init() {
            // Check if user is logged in (from localStorage)
            const savedUser = localStorage.getItem('codeBotUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserUI();
            }

            // Add event listeners
            loginForm.addEventListener('submit', handleLogin);
            registerForm.addEventListener('submit', handleRegister);
            
            // Allow sending message with Enter key
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        }

        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simple validation
            if (!email || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: 'Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯',
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('loginModal');
            
            // Reset form
            loginForm.reset();
        }

               // Handle register
                // Handle register
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            // Simple validation
            if (!name || !email || !password) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }
            
            // In a real app, you would send this to a server
            currentUser = {
                name: name,
                email: email,
                plan: 'free'
            };
            
            // Save to localStorage
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserUI();
            
            // Close modal
            closeModal('registerModal');
            
            // Reset form
            registerForm.reset();
        }

        // Logout user
        function logout() {
            currentUser = null;
            userUsage = 0;
            userFiles = [];
            conversationHistory = [];
            
            // Remove from localStorage
            localStorage.removeItem('codeBotUser');
            
            // Update UI
            updateUserUI();
            
            // Clear chat
            chatMessages.innerHTML = `
                <div class="bot-message">
                    Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ CodeBot Pro ğŸ¤–<br>
                    ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:<br>
                    â€¢ ÙƒØªØ§Ø¨Ø© Ø£ÙƒÙˆØ§Ø¯ Lua, HTML, CSS<br>
                    â€¢ ØªØ¹Ø¯ÙŠÙ„ ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯<br>
                    â€¢ ÙƒØªØ§Ø¨Ø© Ø£ÙƒØ«Ø± Ù…Ù† 100,000 Ø³Ø·Ø± Ø¨Ø³Ø±Ø¹Ø©<br>
                    â€¢ ØªØ­Ù„ÙŠÙ„ ÙˆØ¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡<br><br>
                    ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
                </div>
            `;
        }

        // Update user UI
        function updateUserUI() {
            if (currentUser) {
                // Show user info and logout button
                userInfo.classList.remove('hidden');
                logoutBtn.classList.remove('hidden');
                
                // Hide login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.add('hidden');
                });
                
                // Set user info
                userName.textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser.name}!`;
                
                // Set plan info
                userStatus.textContent = currentUser.plan === 'free' ? 'Ù…Ø¬Ø§Ù†ÙŠ' : 
                                      currentUser.plan === 'pro' ? 'Pro' : 'Enterprise';
                userStatus.className = 'subscription-status ' + 
                                      (currentUser.plan === 'free' ? 'status-free' : 
                                       currentUser.plan === 'pro' ? 'status-pro' : 'status-enterprise');
                
                // Update usage
                updateUsage();
            } else {
                // Hide user info and logout button
                userInfo.classList.add('hidden');
                logoutBtn.classList.add('hidden');
                
                // Show login/register buttons
                document.querySelectorAll('.nav-buttons .btn:not(#logoutBtn)').forEach(btn => {
                    btn.classList.remove('hidden');
                });
            }
        }

        // Update usage progress
        function updateUsage() {
            if (!currentUser) return;
            
            const maxRequests = currentUser.plan === 'free' ? 10 : 
                              currentUser.plan === 'pro' ? 500 : Infinity;
            
            const percentage = Math.min((userUsage / maxRequests) * 100, 100);
            usageProgress.style.width = `${percentage}%`;
            usageText.textContent = currentUser.plan === 'enterprise' ? 
                                  'Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©' : 
                                  `${userUsage}/${maxRequests} Ø·Ù„Ø¨Ø§Øª`;
        }

        // Handle file upload
        function handleFileUpload(input) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª');
                return;
            }
            
            const file = input.files[0];
            if (!file) return;
            
            // Check file type
            const validExtensions = ['.lua', '.html', '.css'];
            const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
            
            if (!validExtensions.includes(fileExt)) {
                alert('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ø¨ØµÙŠØºØ© .lua Ø£Ùˆ .html Ø£Ùˆ .css ÙÙ‚Ø·');
                return;
            }
            
            // Read file content
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                // Add to user files
                userFiles.push({
                    name: file.name,
                    content: content,
                    type: fileExt.substring(1),
                    date: new Date().toLocaleString()
                });
                
                // Display uploaded file
                displayUploadedFiles();
                
                // Add bot message
                addBotMessage(`ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù "${file.name}" Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø·Ù„Ø¨ ØªØ¹Ø¯ÙŠÙ„Ù‡ Ø£Ùˆ ØªØ­Ù„ÙŠÙ„Ù‡.`);
            };
            reader.readAsText(file);
        }

        // Display uploaded files
        function displayUploadedFiles() {
            if (userFiles.length === 0) {
                uploadedFiles.innerHTML = '';
                return;
            }
            
            let html = '<h3>ğŸ“‚ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</h3><ul style="list-style: none; margin-top: 10px;">';
            
            userFiles.forEach((file, index) => {
                html += `
                    <li style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${file.name}</span>
                            <small>${file.date}</small>
                        </div>
                        <small style="color: rgba(255,255,255,0.7);">${file.type.toUpperCase()} - ${Math.ceil(file.content.length / 1024)} KB</small>
                        <div style="margin-top: 5px;">
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="analyzeFile(${index})">ØªØ­Ù„ÙŠÙ„</button>
                            <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="editFile(${index})">ØªØ¹Ø¯ÙŠÙ„</button>
                        </div>
                    </li>
                `;
            });
            
            html += '</ul>';
            uploadedFiles.innerHTML = html;
        }

        // Analyze file
        function analyzeFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            let analysis = '';
            
            // Simple analysis based on file type
            if (file.type === 'lua') {
                analysis = `ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù Lua:
- Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±: ${file.content.split('\n').length}
- Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆØ§Ù„: ${(file.content.match(/function/g) || []).length}
- Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª: ${(file.content.match(/local\s+\w+/g) || []).length}
- ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: ${file.content.includes('require') ? 'ÙˆØ­Ø¯Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ­Ø¯Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©'}`;
            } else if (file.type === 'html') {
                analysis = `ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù HTML:
- Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±: ${(file.content.match(/<\w+/g) || []).length}
- ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: ${file.content.includes('<style>') ? 'CSS Ø¯Ø§Ø®Ù„ÙŠ' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ CSS Ø¯Ø§Ø®Ù„ÙŠ'}
- ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: ${file.content.includes('<script>') ? 'JavaScript Ø¯Ø§Ø®Ù„ÙŠ' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ JavaScript Ø¯Ø§Ø®Ù„ÙŠ'}`;
            } else if (file.type === 'css') {
                analysis = `ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù CSS:
- Ø¹Ø¯Ø¯ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯: ${(file.content.match(/[^{]+\{[^}]+\}/g) || []).length}
- Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª: ${(file.content.match(/--[\w-]+:/g) || []).length}
- ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰: ${file.content.includes('@media') ? 'Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª ÙˆØ³Ø§Ø¦Ø·' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª ÙˆØ³Ø§Ø¦Ø·'}`;
            }
            
            addBotMessage(analysis);
            incrementUsage();
        }

        // Edit file
        function editFile(index) {
            if (!currentUser) return;
            
            const file = userFiles[index];
            addUserMessage(`Ø£Ø±ÙŠØ¯ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù„Ù ${file.name}`);
            
            // Simulate bot thinking
            setTimeout(() => {
                let editedContent = '';
                
                // Simple edits based on file type
                if (file.type === 'lua') {
                    editedContent = file.content + '\n\n-- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro';
                } else if (file.type === 'html') {
                    editedContent = file.content.replace(/<\/body>/, '<!-- ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro -->\n</body>');
                } else if (file.type === 'css') {
                    editedContent = file.content + '\n\n/* ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø© CodeBot Pro */';
                }
                
                // Update file content
                userFiles[index].content = editedContent;
                
                // Show edited content
                addBotMessage(`ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ${file.name}. Ø¥Ù„ÙŠÙƒ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø¯Ù„:`);
                addCodeMessage(editedContent, file.type);
                
                incrementUsage();
            }, 1500);
        }

        // Select plan
        function selectPlan(plan) {
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ø·Ø©');
                return;
            }
            
            currentUser.plan = plan;
            localStorage.setItem('codeBotUser', JSON.stringify(currentUser));
            updateUserUI();
            
            if (plan === 'enterprise') {
                addBotMessage('Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ Ø¨Ø®Ø·Ø© Enterprise! Ø³ÙŠØªØµÙ„ Ø¨Ùƒ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ù‚Ø±ÙŠØ¨Ø§Ù‹.');
            } else {
                addBotMessage(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø´ØªØ±Ø§ÙƒÙƒ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© ${plan === 'pro' ? 'Pro' : 'Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©'} Ø¨Ù†Ø¬Ø§Ø­.`);
            }
        }

        // Send message
        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;
            
            if (!currentUser) {
                alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„');
                return;
            }
            
            // Check daily limit
            if (currentUser.plan === 'free' && userUsage >= 10) {
                alert('Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø²ÙŠØ¯.');
                return;
            } else if (currentUser.plan === 'pro' && userUsage >= 500) {
                alert('Ù„Ù‚Ø¯ ÙˆØµÙ„Øª Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø®Ø·Ø© Pro. Ù‚Ù… Ø¨Ø§Ù„ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ Enterprise Ù„Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©.');
                return;
            }
            
            addUserMessage(message);
            messageInput.value = '';
            
            // Simulate bot thinking
            setTimeout(() => {
                generateBotResponse(message);
                incrementUsage();
            }, 1000);
        }

// Generate bot response
function generateBotResponse(message) {
    let response = '';
    let code = '';
    
    // Convert message to lowercase for easier matching
    const lowerMessage = message.toLowerCase();
    
    // Check for Lua requests
    if (lowerMessage.includes('Ù„ÙˆØ§') || lowerMessage.includes('lua')) {
        if (lowerMessage.includes('Ø¨Ø³ÙŠØ·') || lowerMessage.includes('Ù…Ø«Ø§Ù„') || lowerMessage.includes('Ø¨Ø¯Ø§ÙŠØ©')) {
            code = codeTemplates.lua.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø£Ø³Ø§Ø³ÙŠØ§Ù‹ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Lua Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø¡:';
        } else if (lowerMessage.includes('Ù…ØªÙ‚Ø¯Ù…') || lowerMessage.includes('Ù…Ø¹Ù‚Ø¯') || lowerMessage.includes('Ø§Ø­ØªØ±Ø§ÙÙŠ')) {
            code = codeTemplates.lua.advanced;
            response = 'Ù‡Ø§ Ù‡Ùˆ Ù…Ø«Ø§Ù„ Ù…ØªÙ‚Ø¯Ù… Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Lua ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙƒÙ…Ø±Ø¬Ø¹:';
        } else if (lowerMessage.includes('ÙˆØ¸ÙŠÙØ©') || lowerMessage.includes('Ø¯Ø§Ù„Ø©') || lowerMessage.includes('function')) {
            code = `-- Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© ÙÙŠ Lua
function calculateSum(a, b)
    return a + b
end

-- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø©
local result = calculateSum(5, 3)
print("Ù†Ø§ØªØ¬ Ø§Ù„Ø¬Ù…Ø¹ Ù‡Ùˆ: " .. result)`;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯ÙˆØ§Ù„ ÙÙŠ Lua:';
        } else {
            code = codeTemplates.lua.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Lua ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø¹Ù„ÙŠÙ‡:';
        }
    } 
    // Check for HTML requests
    else if (lowerMessage.includes('html') || lowerMessage.includes('Ø¥ØªØ´ ØªÙŠ Ø¥Ù… Ø¥Ù„') || lowerMessage.includes('ØµÙØ­Ø© ÙˆÙŠØ¨')) {
        if (lowerMessage.includes('Ø¨Ø³ÙŠØ·') || lowerMessage.includes('Ù…Ø«Ø§Ù„') || lowerMessage.includes('Ø¨Ø¯Ø§ÙŠØ©')) {
            code = codeTemplates.html.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù†Ù…ÙˆØ°Ø¬Ø§Ù‹ Ø£Ø³Ø§Ø³ÙŠØ§Ù‹ Ù„ØµÙØ­Ø© HTML ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡:';
        } else if (lowerMessage.includes('Ù…ØªÙ‚Ø¯Ù…') || lowerMessage.includes('Ù…Ø¹Ù‚Ø¯') || lowerMessage.includes('Ø§Ø­ØªØ±Ø§ÙÙŠ')) {
            code = codeTemplates.html.advanced;
            response = 'Ù‡Ø§ Ù‡Ùˆ Ù†Ù…ÙˆØ°Ø¬ Ù…ØªÙ‚Ø¯Ù… Ù„ØµÙØ­Ø© HTML Ø¨ØªØµÙ…ÙŠÙ… Ø­Ø¯ÙŠØ«:';
        } else if (lowerMessage.includes('Ø¬Ø¯ÙˆÙ„') || lowerMessage.includes('table')) {
            code = `<!DOCTYPE html>
<html>
<head>
    <title>Ø¬Ø¯ÙˆÙ„ HTML</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <table>
        <tr>
            <th>Ø§Ù„Ø§Ø³Ù…</th>
            <th>Ø§Ù„Ø¹Ù…Ø±</th>
        </tr>
        <tr>
            <td>Ø£Ø­Ù…Ø¯</td>
            <td>25</td>
        </tr>
        <tr>
            <td>Ù…Ø­Ù…Ø¯</td>
            <td>30</td>
        </tr>
    </table>
</body>
</html>`;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ ÙÙŠ HTML:';
        } else {
            code = codeTemplates.html.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù†Ù…ÙˆØ°Ø¬Ø§Ù‹ Ù„ØµÙØ­Ø© HTML Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ:';
        }
    }
    // Check for CSS requests
    else if (lowerMessage.includes('css') || lowerMessage.includes('Ø³ÙŠ Ø¥Ø³ Ø¥Ø³') || lowerMessage.includes('ØªÙ†Ø³ÙŠÙ‚')) {
        if (lowerMessage.includes('Ø¨Ø³ÙŠØ·') || lowerMessage.includes('Ù…Ø«Ø§Ù„') || lowerMessage.includes('Ø¨Ø¯Ø§ÙŠØ©')) {
            code = codeTemplates.css.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø£Ø³Ø§Ø³ÙŠØ§Ù‹ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ CSS Ù„Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:';
        } else if (lowerMessage.includes('Ù…ØªÙ‚Ø¯Ù…') || lowerMessage.includes('Ù…Ø¹Ù‚Ø¯') || lowerMessage.includes('Ø§Ø­ØªØ±Ø§ÙÙŠ')) {
            code = codeTemplates.css.advanced;
            response = 'Ù‡Ø§ Ù‡Ùˆ Ù…Ø«Ø§Ù„ Ù…ØªÙ‚Ø¯Ù… Ø¹Ù„Ù‰ ÙƒÙˆØ¯ CSS Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØºÙŠØ±Ø§Øª ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø­Ø¯ÙŠØ«Ø©:';
        } else if (lowerMessage.includes('Ù…ØªØ¬Ø§ÙˆØ¨') || lowerMessage.includes('responsive')) {
            code = `/* Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ CSS Ù„Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨ */
.container {
    width: 100%;
    padding: 20px;
}

@media (min-width: 768px) {
    .container {
        width: 750px;
        margin: 0 auto;
    }
}

@media (min-width: 992px) {
    .container {
        width: 970px;
    }
}

@media (min-width: 1200px) {
    .container {
        width: 1170px;
    }
}`;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© Ø¬Ø¹Ù„ Ø§Ù„ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨Ø§Ù‹ Ù…Ø¹ Ù…Ø®ØªÙ„Ù Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª:';
        } else {
            code = codeTemplates.css.basic;
            response = 'Ø¥Ù„ÙŠÙƒ Ù…Ø«Ø§Ù„Ø§Ù‹ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ CSS ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡:';
        }
    }
    // General programming questions
    else if (lowerMessage.includes('Ø¨Ø±Ù…Ø¬Ø©') || lowerMessage.includes('ÙƒÙˆØ¯') || lowerMessage.includes('Ø¨Ø±Ù†Ø§Ù…Ø¬')) {
        response = 'Ø£Ù†Ø§ Ù…ØªØ®ØµØµ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¨Ø£ÙƒÙˆØ§Ø¯ Lua Ùˆ HTML Ùˆ CSS. Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù„ØºØ§Øª ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠÙ‡Ø§ØŸ';
    }
    // If no specific request
    else {
        const randomResponses = [
            'Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙˆØ¶ÙŠØ­ Ø·Ù„Ø¨Ùƒ Ø£ÙƒØ«Ø±ØŸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Lua Ø£Ùˆ HTML Ø£Ùˆ CSSØŸ',
            'Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ÙƒØªØ§Ø¨Ø© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯. Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„ÙŠÙ‡Ø§ØŸ',
            'Ù„Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„ØŒ Ø£Ø®Ø¨Ø±Ù†ÙŠ Ù…Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Lua Ø£Ùˆ HTML Ø£Ùˆ CSS.',
            'Ø£Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„. Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ù„ØºØ© Ø¨Ø±Ù…Ø¬Ø© Ù…Ø¹ÙŠÙ†Ø© Ù…Ø«Ù„ Lua Ø£Ùˆ HTML Ø£Ùˆ CSSØŸ'
        ];
        response = randomResponses[Math.floor(Math.random() * randomResponses.length)];
    }
    
    if (response) {
        addBotMessage(response);
    }
    
    if (code) {
        addCodeMessage(code, lowerMessage.includes('Ù„ÙˆØ§') ? 'lua' : 
                             lowerMessage.includes('html') ? 'html' : 'css');
    }
}

        // Add user message to chat
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'user',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add bot message to chat
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: text,
                time: new Date().toLocaleTimeString()
            });
        }

        // Add code message to chat
        function addCodeMessage(code, language) {
            const codeDiv = document.createElement('pre');
            codeDiv.className = 'code-editor';
            codeDiv.textContent = code;
            codeDiv.setAttribute('data-language', language);
            chatMessages.appendChild(codeDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add copy button
            const copyBtn = document.createElement('button');
            copyBtn.className = 'btn btn-secondary';
            copyBtn.textContent = 'Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯';
            copyBtn.style.marginTop = '10px';
            copyBtn.onclick = function() {
                navigator.clipboard.writeText(code);
                copyBtn.textContent = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                setTimeout(() => {
                    copyBtn.textContent = 'Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯';
                }, 2000);
            };
            
            const container = document.createElement('div');
            container.className = 'bot-message';
            container.appendChild(copyBtn);
            chatMessages.appendChild(container);
            
            // Add to conversation history
            conversationHistory.push({
                sender: 'bot',
                message: '[CODE]',
                code: code,
                language: language,
                time: new Date().toLocaleTimeString()
            });
        }

        // Increment usage counter
        function incrementUsage() {
            if (currentUser && currentUser.plan !== 'enterprise') {
                userUsage++;
                localStorage.setItem('codeBotUsage', userUsage);
                updateUsage();
            }
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            init();
            
            // Load usage from localStorage
            const savedUsage = localStorage.getItem('codeBotUsage');
            if (savedUsage) {
                userUsage = parseInt(savedUsage);
                updateUsage();
            }
            
            // Check if usage should reset (new day)
            const lastUsageDate = localStorage.getItem('codeBotUsageDate');
            const today = new Date().toDateString();
            
            if (lastUsageDate !== today) {
                userUsage = 0;
                localStorage.setItem('codeBotUsage', '0');
                localStorage.setItem('codeBotUsageDate', today);
                updateUsage();
            }
        });
    </script>
</body>
</html>